module {
  llvm.func @malloc(i64) -> !llvm.ptr
  func.func @linear_layer_f32(%arg0: tensor<32x128xf32>, %arg1: tensor<128x64xf32>, %arg2: tensor<64xf32>) -> tensor<32x64xf32> {
    %0 = llvm.mlir.constant(1 : index) : i64
    %1 = llvm.mlir.constant(1 : index) : i64
    %2 = llvm.mlir.constant(1 : index) : i64
    %3 = llvm.mlir.zero : !llvm.ptr
    %4 = llvm.getelementptr %3[%0] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %5 = llvm.ptrtoint %4 : !llvm.ptr to i64
    %6 = llvm.call @malloc(%5) : (i64) -> !llvm.ptr
    %7 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %8 = llvm.insertvalue %6, %7[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %9 = llvm.insertvalue %6, %8[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %10 = llvm.mlir.constant(0 : index) : i64
    %11 = llvm.insertvalue %10, %9[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %12 = llvm.insertvalue %0, %11[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %13 = llvm.insertvalue %1, %12[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %14 = llvm.insertvalue %1, %13[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %15 = llvm.insertvalue %2, %14[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %16 = llvm.mlir.constant(1 : index) : i64
    %17 = llvm.mlir.constant(1 : index) : i64
    %18 = llvm.mlir.constant(1 : index) : i64
    %19 = llvm.mlir.zero : !llvm.ptr
    %20 = llvm.getelementptr %19[%16] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %21 = llvm.ptrtoint %20 : !llvm.ptr to i64
    %22 = llvm.call @malloc(%21) : (i64) -> !llvm.ptr
    %23 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %24 = llvm.insertvalue %22, %23[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %25 = llvm.insertvalue %22, %24[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %26 = llvm.mlir.constant(0 : index) : i64
    %27 = llvm.insertvalue %26, %25[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %28 = llvm.insertvalue %16, %27[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %29 = llvm.insertvalue %17, %28[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %30 = llvm.insertvalue %17, %29[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %31 = llvm.insertvalue %18, %30[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %32 = llvm.mlir.constant(0.000000e+00 : f32) : f32
    %33 = bufferization.to_buffer %arg2 : tensor<64xf32> to memref<64xf32, strided<[?], offset: ?>>
    %34 = builtin.unrealized_conversion_cast %33 : memref<64xf32, strided<[?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)>
    %35 = bufferization.to_buffer %arg1 : tensor<128x64xf32> to memref<128x64xf32, strided<[?, ?], offset: ?>>
    %36 = builtin.unrealized_conversion_cast %35 : memref<128x64xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %37 = bufferization.to_buffer %arg0 : tensor<32x128xf32> to memref<32x128xf32, strided<[?, ?], offset: ?>>
    %38 = builtin.unrealized_conversion_cast %37 : memref<32x128xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %39 = llvm.mlir.constant(32 : index) : i64
    %40 = llvm.mlir.constant(64 : index) : i64
    %41 = llvm.mlir.constant(1 : index) : i64
    %42 = llvm.mlir.constant(2048 : index) : i64
    %43 = llvm.mlir.zero : !llvm.ptr
    %44 = llvm.getelementptr %43[%42] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %45 = llvm.ptrtoint %44 : !llvm.ptr to i64
    %46 = llvm.mlir.constant(64 : index) : i64
    %47 = llvm.add %45, %46 : i64
    %48 = llvm.call @malloc(%47) : (i64) -> !llvm.ptr
    %49 = llvm.ptrtoint %48 : !llvm.ptr to i64
    %50 = llvm.mlir.constant(1 : index) : i64
    %51 = llvm.sub %46, %50 : i64
    %52 = llvm.add %49, %51 : i64
    %53 = llvm.urem %52, %46 : i64
    %54 = llvm.sub %52, %53 : i64
    %55 = llvm.inttoptr %54 : i64 to !llvm.ptr
    %56 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %57 = llvm.insertvalue %48, %56[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %58 = llvm.insertvalue %55, %57[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %59 = llvm.mlir.constant(0 : index) : i64
    %60 = llvm.insertvalue %59, %58[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %61 = llvm.insertvalue %39, %60[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %62 = llvm.insertvalue %40, %61[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %63 = llvm.insertvalue %40, %62[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %64 = llvm.insertvalue %41, %63[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %65 = builtin.unrealized_conversion_cast %64 : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> to memref<32x64xf32>
    %66 = llvm.mlir.constant(32 : index) : i64
    %67 = llvm.mlir.constant(64 : index) : i64
    %68 = llvm.mlir.constant(2048 : index) : i64
    %69 = llvm.mlir.constant(0 : index) : i64
    %70 = builtin.unrealized_conversion_cast %69 : i64 to index
    %71 = llvm.mlir.constant(2048 : index) : i64
    %72 = builtin.unrealized_conversion_cast %71 : i64 to index
    %73 = llvm.mlir.constant(1 : index) : i64
    %74 = builtin.unrealized_conversion_cast %73 : i64 to index
    scf.for %arg3 = %70 to %72 step %74 {
      %76 = builtin.unrealized_conversion_cast %arg3 : index to i64
      %77 = llvm.srem %76, %67 : i64
      %78 = llvm.mlir.constant(0 : index) : i64
      %79 = llvm.icmp "slt" %77, %78 : i64
      %80 = llvm.add %77, %67 : i64
      %81 = llvm.select %79, %80, %77 : i1, i64
      %82 = llvm.mlir.constant(0 : index) : i64
      %83 = llvm.mlir.constant(-1 : index) : i64
      %84 = llvm.icmp "slt" %76, %82 : i64
      %85 = llvm.sub %83, %76 : i64
      %86 = llvm.select %84, %85, %76 : i1, i64
      %87 = llvm.sdiv %86, %67 : i64
      %88 = llvm.sub %83, %87 : i64
      %89 = llvm.select %84, %88, %87 : i1, i64
      %90 = llvm.mlir.constant(0 : index) : i64
      %91 = builtin.unrealized_conversion_cast %90 : i64 to index
      %92 = llvm.mlir.constant(128 : index) : i64
      %93 = builtin.unrealized_conversion_cast %92 : i64 to index
      %94 = llvm.mlir.constant(1 : index) : i64
      %95 = builtin.unrealized_conversion_cast %94 : i64 to index
      scf.for %arg4 = %91 to %93 step %95 {
        %127 = builtin.unrealized_conversion_cast %arg4 : index to i64
        %128 = llvm.extractvalue %38[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %129 = llvm.extractvalue %38[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %130 = llvm.getelementptr %128[%129] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %131 = llvm.extractvalue %38[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %132 = llvm.mul %89, %131 overflow<nsw, nuw> : i64
        %133 = llvm.extractvalue %38[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %134 = llvm.mul %127, %133 overflow<nsw, nuw> : i64
        %135 = llvm.add %132, %134 overflow<nsw, nuw> : i64
        %136 = llvm.getelementptr inbounds|nuw %130[%135] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %137 = llvm.load %136 : !llvm.ptr -> f32
        %138 = llvm.extractvalue %36[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %139 = llvm.extractvalue %36[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %140 = llvm.getelementptr %138[%139] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %141 = llvm.extractvalue %36[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %142 = llvm.mul %127, %141 overflow<nsw, nuw> : i64
        %143 = llvm.extractvalue %36[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %144 = llvm.mul %81, %143 overflow<nsw, nuw> : i64
        %145 = llvm.add %142, %144 overflow<nsw, nuw> : i64
        %146 = llvm.getelementptr inbounds|nuw %140[%145] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %147 = llvm.load %146 : !llvm.ptr -> f32
        %148 = llvm.mlir.constant(0 : index) : i64
        %149 = llvm.mlir.constant(0 : index) : i64
        %150 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %151 = llvm.add %148, %149 overflow<nsw, nuw> : i64
        %152 = llvm.getelementptr inbounds|nuw %150[%151] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %153 = llvm.load %152 : !llvm.ptr -> f32
        %154 = llvm.fmul %137, %147 : f32
        %155 = llvm.fadd %153, %154 : f32
        %156 = llvm.mlir.constant(0 : index) : i64
        %157 = llvm.mlir.constant(0 : index) : i64
        %158 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %159 = llvm.add %156, %157 overflow<nsw, nuw> : i64
        %160 = llvm.getelementptr inbounds|nuw %158[%159] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        llvm.store %155, %160 : f32, !llvm.ptr
      }
      %96 = llvm.extractvalue %34[1] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %97 = llvm.extractvalue %34[2] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %98 = llvm.getelementptr %96[%97] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %99 = llvm.extractvalue %34[4, 0] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %100 = llvm.mul %81, %99 overflow<nsw, nuw> : i64
      %101 = llvm.getelementptr inbounds|nuw %98[%100] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %102 = llvm.load %101 : !llvm.ptr -> f32
      %103 = llvm.mlir.constant(0 : index) : i64
      %104 = llvm.mlir.constant(0 : index) : i64
      %105 = llvm.extractvalue %31[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %106 = llvm.add %103, %104 overflow<nsw, nuw> : i64
      %107 = llvm.getelementptr inbounds|nuw %105[%106] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %102, %107 : f32, !llvm.ptr
      %108 = llvm.mlir.constant(0 : index) : i64
      %109 = llvm.mlir.constant(0 : index) : i64
      %110 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %111 = llvm.add %108, %109 overflow<nsw, nuw> : i64
      %112 = llvm.getelementptr inbounds|nuw %110[%111] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %113 = llvm.load %112 : !llvm.ptr -> f32
      %114 = llvm.mlir.constant(0 : index) : i64
      %115 = llvm.mlir.constant(0 : index) : i64
      %116 = llvm.extractvalue %31[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %117 = llvm.add %114, %115 overflow<nsw, nuw> : i64
      %118 = llvm.getelementptr inbounds|nuw %116[%117] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %119 = llvm.load %118 : !llvm.ptr -> f32
      %120 = llvm.fadd %113, %119 : f32
      %121 = llvm.intr.maximum(%120, %32) : (f32, f32) -> f32
      %122 = llvm.extractvalue %64[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %123 = llvm.mlir.constant(64 : index) : i64
      %124 = llvm.mul %89, %123 overflow<nsw, nuw> : i64
      %125 = llvm.add %124, %81 overflow<nsw, nuw> : i64
      %126 = llvm.getelementptr inbounds|nuw %122[%125] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %121, %126 : f32, !llvm.ptr
    }
    %75 = bufferization.to_tensor %65 : memref<32x64xf32> to tensor<32x64xf32>
    return %75 : tensor<32x64xf32>
  }
  func.func @large_linear_layer_f32(%arg0: tensor<256x512xf32>, %arg1: tensor<512x256xf32>, %arg2: tensor<256xf32>) -> tensor<256x256xf32> {
    %0 = llvm.mlir.constant(1 : index) : i64
    %1 = llvm.mlir.constant(1 : index) : i64
    %2 = llvm.mlir.constant(1 : index) : i64
    %3 = llvm.mlir.zero : !llvm.ptr
    %4 = llvm.getelementptr %3[%0] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %5 = llvm.ptrtoint %4 : !llvm.ptr to i64
    %6 = llvm.call @malloc(%5) : (i64) -> !llvm.ptr
    %7 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %8 = llvm.insertvalue %6, %7[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %9 = llvm.insertvalue %6, %8[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %10 = llvm.mlir.constant(0 : index) : i64
    %11 = llvm.insertvalue %10, %9[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %12 = llvm.insertvalue %0, %11[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %13 = llvm.insertvalue %1, %12[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %14 = llvm.insertvalue %1, %13[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %15 = llvm.insertvalue %2, %14[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %16 = llvm.mlir.constant(1 : index) : i64
    %17 = llvm.mlir.constant(1 : index) : i64
    %18 = llvm.mlir.constant(1 : index) : i64
    %19 = llvm.mlir.zero : !llvm.ptr
    %20 = llvm.getelementptr %19[%16] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %21 = llvm.ptrtoint %20 : !llvm.ptr to i64
    %22 = llvm.call @malloc(%21) : (i64) -> !llvm.ptr
    %23 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %24 = llvm.insertvalue %22, %23[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %25 = llvm.insertvalue %22, %24[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %26 = llvm.mlir.constant(0 : index) : i64
    %27 = llvm.insertvalue %26, %25[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %28 = llvm.insertvalue %16, %27[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %29 = llvm.insertvalue %17, %28[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %30 = llvm.insertvalue %17, %29[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %31 = llvm.insertvalue %18, %30[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %32 = llvm.mlir.constant(0.000000e+00 : f32) : f32
    %33 = bufferization.to_buffer %arg2 : tensor<256xf32> to memref<256xf32, strided<[?], offset: ?>>
    %34 = builtin.unrealized_conversion_cast %33 : memref<256xf32, strided<[?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)>
    %35 = bufferization.to_buffer %arg1 : tensor<512x256xf32> to memref<512x256xf32, strided<[?, ?], offset: ?>>
    %36 = builtin.unrealized_conversion_cast %35 : memref<512x256xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %37 = bufferization.to_buffer %arg0 : tensor<256x512xf32> to memref<256x512xf32, strided<[?, ?], offset: ?>>
    %38 = builtin.unrealized_conversion_cast %37 : memref<256x512xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %39 = llvm.mlir.constant(256 : index) : i64
    %40 = llvm.mlir.constant(256 : index) : i64
    %41 = llvm.mlir.constant(1 : index) : i64
    %42 = llvm.mlir.constant(65536 : index) : i64
    %43 = llvm.mlir.zero : !llvm.ptr
    %44 = llvm.getelementptr %43[%42] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %45 = llvm.ptrtoint %44 : !llvm.ptr to i64
    %46 = llvm.mlir.constant(64 : index) : i64
    %47 = llvm.add %45, %46 : i64
    %48 = llvm.call @malloc(%47) : (i64) -> !llvm.ptr
    %49 = llvm.ptrtoint %48 : !llvm.ptr to i64
    %50 = llvm.mlir.constant(1 : index) : i64
    %51 = llvm.sub %46, %50 : i64
    %52 = llvm.add %49, %51 : i64
    %53 = llvm.urem %52, %46 : i64
    %54 = llvm.sub %52, %53 : i64
    %55 = llvm.inttoptr %54 : i64 to !llvm.ptr
    %56 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %57 = llvm.insertvalue %48, %56[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %58 = llvm.insertvalue %55, %57[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %59 = llvm.mlir.constant(0 : index) : i64
    %60 = llvm.insertvalue %59, %58[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %61 = llvm.insertvalue %39, %60[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %62 = llvm.insertvalue %40, %61[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %63 = llvm.insertvalue %40, %62[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %64 = llvm.insertvalue %41, %63[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %65 = builtin.unrealized_conversion_cast %64 : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> to memref<256x256xf32>
    %66 = llvm.mlir.constant(256 : index) : i64
    %67 = llvm.mlir.constant(256 : index) : i64
    %68 = llvm.mlir.constant(65536 : index) : i64
    %69 = llvm.mlir.constant(0 : index) : i64
    %70 = builtin.unrealized_conversion_cast %69 : i64 to index
    %71 = llvm.mlir.constant(65536 : index) : i64
    %72 = builtin.unrealized_conversion_cast %71 : i64 to index
    %73 = llvm.mlir.constant(1 : index) : i64
    %74 = builtin.unrealized_conversion_cast %73 : i64 to index
    scf.for %arg3 = %70 to %72 step %74 {
      %76 = builtin.unrealized_conversion_cast %arg3 : index to i64
      %77 = llvm.srem %76, %67 : i64
      %78 = llvm.mlir.constant(0 : index) : i64
      %79 = llvm.icmp "slt" %77, %78 : i64
      %80 = llvm.add %77, %67 : i64
      %81 = llvm.select %79, %80, %77 : i1, i64
      %82 = llvm.mlir.constant(0 : index) : i64
      %83 = llvm.mlir.constant(-1 : index) : i64
      %84 = llvm.icmp "slt" %76, %82 : i64
      %85 = llvm.sub %83, %76 : i64
      %86 = llvm.select %84, %85, %76 : i1, i64
      %87 = llvm.sdiv %86, %67 : i64
      %88 = llvm.sub %83, %87 : i64
      %89 = llvm.select %84, %88, %87 : i1, i64
      %90 = llvm.mlir.constant(0 : index) : i64
      %91 = builtin.unrealized_conversion_cast %90 : i64 to index
      %92 = llvm.mlir.constant(512 : index) : i64
      %93 = builtin.unrealized_conversion_cast %92 : i64 to index
      %94 = llvm.mlir.constant(1 : index) : i64
      %95 = builtin.unrealized_conversion_cast %94 : i64 to index
      scf.for %arg4 = %91 to %93 step %95 {
        %127 = builtin.unrealized_conversion_cast %arg4 : index to i64
        %128 = llvm.extractvalue %38[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %129 = llvm.extractvalue %38[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %130 = llvm.getelementptr %128[%129] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %131 = llvm.extractvalue %38[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %132 = llvm.mul %89, %131 overflow<nsw, nuw> : i64
        %133 = llvm.extractvalue %38[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %134 = llvm.mul %127, %133 overflow<nsw, nuw> : i64
        %135 = llvm.add %132, %134 overflow<nsw, nuw> : i64
        %136 = llvm.getelementptr inbounds|nuw %130[%135] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %137 = llvm.load %136 : !llvm.ptr -> f32
        %138 = llvm.extractvalue %36[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %139 = llvm.extractvalue %36[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %140 = llvm.getelementptr %138[%139] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %141 = llvm.extractvalue %36[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %142 = llvm.mul %127, %141 overflow<nsw, nuw> : i64
        %143 = llvm.extractvalue %36[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %144 = llvm.mul %81, %143 overflow<nsw, nuw> : i64
        %145 = llvm.add %142, %144 overflow<nsw, nuw> : i64
        %146 = llvm.getelementptr inbounds|nuw %140[%145] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %147 = llvm.load %146 : !llvm.ptr -> f32
        %148 = llvm.mlir.constant(0 : index) : i64
        %149 = llvm.mlir.constant(0 : index) : i64
        %150 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %151 = llvm.add %148, %149 overflow<nsw, nuw> : i64
        %152 = llvm.getelementptr inbounds|nuw %150[%151] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %153 = llvm.load %152 : !llvm.ptr -> f32
        %154 = llvm.fmul %137, %147 : f32
        %155 = llvm.fadd %153, %154 : f32
        %156 = llvm.mlir.constant(0 : index) : i64
        %157 = llvm.mlir.constant(0 : index) : i64
        %158 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %159 = llvm.add %156, %157 overflow<nsw, nuw> : i64
        %160 = llvm.getelementptr inbounds|nuw %158[%159] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        llvm.store %155, %160 : f32, !llvm.ptr
      }
      %96 = llvm.extractvalue %34[1] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %97 = llvm.extractvalue %34[2] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %98 = llvm.getelementptr %96[%97] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %99 = llvm.extractvalue %34[4, 0] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %100 = llvm.mul %81, %99 overflow<nsw, nuw> : i64
      %101 = llvm.getelementptr inbounds|nuw %98[%100] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %102 = llvm.load %101 : !llvm.ptr -> f32
      %103 = llvm.mlir.constant(0 : index) : i64
      %104 = llvm.mlir.constant(0 : index) : i64
      %105 = llvm.extractvalue %31[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %106 = llvm.add %103, %104 overflow<nsw, nuw> : i64
      %107 = llvm.getelementptr inbounds|nuw %105[%106] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %102, %107 : f32, !llvm.ptr
      %108 = llvm.mlir.constant(0 : index) : i64
      %109 = llvm.mlir.constant(0 : index) : i64
      %110 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %111 = llvm.add %108, %109 overflow<nsw, nuw> : i64
      %112 = llvm.getelementptr inbounds|nuw %110[%111] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %113 = llvm.load %112 : !llvm.ptr -> f32
      %114 = llvm.mlir.constant(0 : index) : i64
      %115 = llvm.mlir.constant(0 : index) : i64
      %116 = llvm.extractvalue %31[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %117 = llvm.add %114, %115 overflow<nsw, nuw> : i64
      %118 = llvm.getelementptr inbounds|nuw %116[%117] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %119 = llvm.load %118 : !llvm.ptr -> f32
      %120 = llvm.fadd %113, %119 : f32
      %121 = llvm.intr.maximum(%120, %32) : (f32, f32) -> f32
      %122 = llvm.extractvalue %64[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %123 = llvm.mlir.constant(256 : index) : i64
      %124 = llvm.mul %89, %123 overflow<nsw, nuw> : i64
      %125 = llvm.add %124, %81 overflow<nsw, nuw> : i64
      %126 = llvm.getelementptr inbounds|nuw %122[%125] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %121, %126 : f32, !llvm.ptr
    }
    %75 = bufferization.to_tensor %65 : memref<256x256xf32> to tensor<256x256xf32>
    return %75 : tensor<256x256xf32>
  }
  func.func @small_batch_linear_f32(%arg0: tensor<1x784xf32>, %arg1: tensor<784x128xf32>, %arg2: tensor<128xf32>) -> tensor<1x128xf32> {
    %0 = llvm.mlir.constant(1 : index) : i64
    %1 = llvm.mlir.constant(1 : index) : i64
    %2 = llvm.mlir.constant(1 : index) : i64
    %3 = llvm.mlir.zero : !llvm.ptr
    %4 = llvm.getelementptr %3[%0] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %5 = llvm.ptrtoint %4 : !llvm.ptr to i64
    %6 = llvm.call @malloc(%5) : (i64) -> !llvm.ptr
    %7 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %8 = llvm.insertvalue %6, %7[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %9 = llvm.insertvalue %6, %8[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %10 = llvm.mlir.constant(0 : index) : i64
    %11 = llvm.insertvalue %10, %9[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %12 = llvm.insertvalue %0, %11[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %13 = llvm.insertvalue %1, %12[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %14 = llvm.insertvalue %1, %13[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %15 = llvm.insertvalue %2, %14[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %16 = llvm.mlir.constant(0 : index) : i64
    %17 = llvm.mlir.constant(1 : index) : i64
    %18 = llvm.mlir.constant(1 : index) : i64
    %19 = llvm.mlir.constant(1 : index) : i64
    %20 = llvm.mlir.zero : !llvm.ptr
    %21 = llvm.getelementptr %20[%17] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %22 = llvm.ptrtoint %21 : !llvm.ptr to i64
    %23 = llvm.call @malloc(%22) : (i64) -> !llvm.ptr
    %24 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %25 = llvm.insertvalue %23, %24[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %26 = llvm.insertvalue %23, %25[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %27 = llvm.mlir.constant(0 : index) : i64
    %28 = llvm.insertvalue %27, %26[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %29 = llvm.insertvalue %17, %28[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %30 = llvm.insertvalue %18, %29[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %31 = llvm.insertvalue %18, %30[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %32 = llvm.insertvalue %19, %31[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %33 = llvm.mlir.constant(0 : index) : i64
    %34 = llvm.mlir.constant(0.000000e+00 : f32) : f32
    %35 = bufferization.to_buffer %arg2 : tensor<128xf32> to memref<128xf32, strided<[?], offset: ?>>
    %36 = builtin.unrealized_conversion_cast %35 : memref<128xf32, strided<[?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)>
    %37 = bufferization.to_buffer %arg1 : tensor<784x128xf32> to memref<784x128xf32, strided<[?, ?], offset: ?>>
    %38 = builtin.unrealized_conversion_cast %37 : memref<784x128xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %39 = bufferization.to_buffer %arg0 : tensor<1x784xf32> to memref<1x784xf32, strided<[?, ?], offset: ?>>
    %40 = builtin.unrealized_conversion_cast %39 : memref<1x784xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %41 = llvm.mlir.constant(1 : index) : i64
    %42 = llvm.mlir.constant(128 : index) : i64
    %43 = llvm.mlir.constant(1 : index) : i64
    %44 = llvm.mlir.constant(128 : index) : i64
    %45 = llvm.mlir.zero : !llvm.ptr
    %46 = llvm.getelementptr %45[%44] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %47 = llvm.ptrtoint %46 : !llvm.ptr to i64
    %48 = llvm.mlir.constant(64 : index) : i64
    %49 = llvm.add %47, %48 : i64
    %50 = llvm.call @malloc(%49) : (i64) -> !llvm.ptr
    %51 = llvm.ptrtoint %50 : !llvm.ptr to i64
    %52 = llvm.mlir.constant(1 : index) : i64
    %53 = llvm.sub %48, %52 : i64
    %54 = llvm.add %51, %53 : i64
    %55 = llvm.urem %54, %48 : i64
    %56 = llvm.sub %54, %55 : i64
    %57 = llvm.inttoptr %56 : i64 to !llvm.ptr
    %58 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %59 = llvm.insertvalue %50, %58[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %60 = llvm.insertvalue %57, %59[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %61 = llvm.mlir.constant(0 : index) : i64
    %62 = llvm.insertvalue %61, %60[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %63 = llvm.insertvalue %41, %62[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %64 = llvm.insertvalue %42, %63[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %65 = llvm.insertvalue %42, %64[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %66 = llvm.insertvalue %43, %65[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %67 = builtin.unrealized_conversion_cast %66 : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> to memref<1x128xf32>
    %68 = llvm.mlir.constant(1 : index) : i64
    %69 = llvm.mlir.constant(128 : index) : i64
    %70 = llvm.mlir.constant(128 : index) : i64
    %71 = llvm.mlir.constant(0 : index) : i64
    %72 = builtin.unrealized_conversion_cast %71 : i64 to index
    %73 = llvm.mlir.constant(128 : index) : i64
    %74 = builtin.unrealized_conversion_cast %73 : i64 to index
    %75 = llvm.mlir.constant(1 : index) : i64
    %76 = builtin.unrealized_conversion_cast %75 : i64 to index
    scf.for %arg3 = %72 to %74 step %76 {
      %78 = builtin.unrealized_conversion_cast %arg3 : index to i64
      %79 = llvm.srem %78, %69 : i64
      %80 = llvm.mlir.constant(0 : index) : i64
      %81 = llvm.icmp "slt" %79, %80 : i64
      %82 = llvm.add %79, %69 : i64
      %83 = llvm.select %81, %82, %79 : i1, i64
      %84 = llvm.mlir.constant(0 : index) : i64
      %85 = llvm.mlir.constant(-1 : index) : i64
      %86 = llvm.icmp "slt" %78, %84 : i64
      %87 = llvm.sub %85, %78 : i64
      %88 = llvm.select %86, %87, %78 : i1, i64
      %89 = llvm.sdiv %88, %69 : i64
      %90 = llvm.sub %85, %89 : i64
      %91 = llvm.select %86, %90, %89 : i1, i64
      %92 = llvm.mlir.constant(0 : index) : i64
      %93 = builtin.unrealized_conversion_cast %92 : i64 to index
      %94 = llvm.mlir.constant(784 : index) : i64
      %95 = builtin.unrealized_conversion_cast %94 : i64 to index
      %96 = llvm.mlir.constant(1 : index) : i64
      %97 = builtin.unrealized_conversion_cast %96 : i64 to index
      scf.for %arg4 = %93 to %95 step %97 {
        %127 = builtin.unrealized_conversion_cast %arg4 : index to i64
        %128 = llvm.extractvalue %40[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %129 = llvm.extractvalue %40[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %130 = llvm.getelementptr %128[%129] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %131 = llvm.extractvalue %40[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %132 = llvm.mul %16, %131 overflow<nsw, nuw> : i64
        %133 = llvm.extractvalue %40[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %134 = llvm.mul %127, %133 overflow<nsw, nuw> : i64
        %135 = llvm.add %132, %134 overflow<nsw, nuw> : i64
        %136 = llvm.getelementptr inbounds|nuw %130[%135] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %137 = llvm.load %136 : !llvm.ptr -> f32
        %138 = llvm.extractvalue %38[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %139 = llvm.extractvalue %38[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %140 = llvm.getelementptr %138[%139] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %141 = llvm.extractvalue %38[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %142 = llvm.mul %127, %141 overflow<nsw, nuw> : i64
        %143 = llvm.extractvalue %38[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %144 = llvm.mul %83, %143 overflow<nsw, nuw> : i64
        %145 = llvm.add %142, %144 overflow<nsw, nuw> : i64
        %146 = llvm.getelementptr inbounds|nuw %140[%145] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %147 = llvm.load %146 : !llvm.ptr -> f32
        %148 = llvm.mlir.constant(0 : index) : i64
        %149 = llvm.mlir.constant(0 : index) : i64
        %150 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %151 = llvm.add %148, %149 overflow<nsw, nuw> : i64
        %152 = llvm.getelementptr inbounds|nuw %150[%151] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %153 = llvm.load %152 : !llvm.ptr -> f32
        %154 = llvm.fmul %137, %147 : f32
        %155 = llvm.fadd %153, %154 : f32
        %156 = llvm.mlir.constant(0 : index) : i64
        %157 = llvm.mlir.constant(0 : index) : i64
        %158 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %159 = llvm.add %156, %157 overflow<nsw, nuw> : i64
        %160 = llvm.getelementptr inbounds|nuw %158[%159] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        llvm.store %155, %160 : f32, !llvm.ptr
      }
      %98 = llvm.extractvalue %36[1] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %99 = llvm.extractvalue %36[2] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %100 = llvm.getelementptr %98[%99] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %101 = llvm.extractvalue %36[4, 0] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %102 = llvm.mul %83, %101 overflow<nsw, nuw> : i64
      %103 = llvm.getelementptr inbounds|nuw %100[%102] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %104 = llvm.load %103 : !llvm.ptr -> f32
      %105 = llvm.mlir.constant(0 : index) : i64
      %106 = llvm.mlir.constant(0 : index) : i64
      %107 = llvm.extractvalue %32[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %108 = llvm.add %105, %106 overflow<nsw, nuw> : i64
      %109 = llvm.getelementptr inbounds|nuw %107[%108] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %104, %109 : f32, !llvm.ptr
      %110 = llvm.mlir.constant(0 : index) : i64
      %111 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %112 = llvm.add %91, %110 overflow<nsw, nuw> : i64
      %113 = llvm.getelementptr inbounds|nuw %111[%112] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %114 = llvm.load %113 : !llvm.ptr -> f32
      %115 = llvm.mlir.constant(0 : index) : i64
      %116 = llvm.extractvalue %32[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %117 = llvm.add %91, %115 overflow<nsw, nuw> : i64
      %118 = llvm.getelementptr inbounds|nuw %116[%117] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %119 = llvm.load %118 : !llvm.ptr -> f32
      %120 = llvm.fadd %114, %119 : f32
      %121 = llvm.intr.maximum(%120, %34) : (f32, f32) -> f32
      %122 = llvm.extractvalue %66[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %123 = llvm.mlir.constant(128 : index) : i64
      %124 = llvm.mul %91, %123 overflow<nsw, nuw> : i64
      %125 = llvm.add %124, %83 overflow<nsw, nuw> : i64
      %126 = llvm.getelementptr inbounds|nuw %122[%125] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %121, %126 : f32, !llvm.ptr
    }
    %77 = bufferization.to_tensor %67 : memref<1x128xf32> to tensor<1x128xf32>
    return %77 : tensor<1x128xf32>
  }
  func.func @wide_linear_layer_f32(%arg0: tensor<64x256xf32>, %arg1: tensor<256x1024xf32>, %arg2: tensor<1024xf32>) -> tensor<64x1024xf32> {
    %0 = llvm.mlir.constant(1 : index) : i64
    %1 = llvm.mlir.constant(1 : index) : i64
    %2 = llvm.mlir.constant(1 : index) : i64
    %3 = llvm.mlir.zero : !llvm.ptr
    %4 = llvm.getelementptr %3[%0] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %5 = llvm.ptrtoint %4 : !llvm.ptr to i64
    %6 = llvm.call @malloc(%5) : (i64) -> !llvm.ptr
    %7 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %8 = llvm.insertvalue %6, %7[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %9 = llvm.insertvalue %6, %8[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %10 = llvm.mlir.constant(0 : index) : i64
    %11 = llvm.insertvalue %10, %9[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %12 = llvm.insertvalue %0, %11[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %13 = llvm.insertvalue %1, %12[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %14 = llvm.insertvalue %1, %13[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %15 = llvm.insertvalue %2, %14[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %16 = llvm.mlir.constant(1 : index) : i64
    %17 = llvm.mlir.constant(1 : index) : i64
    %18 = llvm.mlir.constant(1 : index) : i64
    %19 = llvm.mlir.zero : !llvm.ptr
    %20 = llvm.getelementptr %19[%16] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %21 = llvm.ptrtoint %20 : !llvm.ptr to i64
    %22 = llvm.call @malloc(%21) : (i64) -> !llvm.ptr
    %23 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %24 = llvm.insertvalue %22, %23[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %25 = llvm.insertvalue %22, %24[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %26 = llvm.mlir.constant(0 : index) : i64
    %27 = llvm.insertvalue %26, %25[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %28 = llvm.insertvalue %16, %27[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %29 = llvm.insertvalue %17, %28[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %30 = llvm.insertvalue %17, %29[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %31 = llvm.insertvalue %18, %30[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %32 = llvm.mlir.constant(0.000000e+00 : f32) : f32
    %33 = bufferization.to_buffer %arg2 : tensor<1024xf32> to memref<1024xf32, strided<[?], offset: ?>>
    %34 = builtin.unrealized_conversion_cast %33 : memref<1024xf32, strided<[?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)>
    %35 = bufferization.to_buffer %arg1 : tensor<256x1024xf32> to memref<256x1024xf32, strided<[?, ?], offset: ?>>
    %36 = builtin.unrealized_conversion_cast %35 : memref<256x1024xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %37 = bufferization.to_buffer %arg0 : tensor<64x256xf32> to memref<64x256xf32, strided<[?, ?], offset: ?>>
    %38 = builtin.unrealized_conversion_cast %37 : memref<64x256xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %39 = llvm.mlir.constant(64 : index) : i64
    %40 = llvm.mlir.constant(1024 : index) : i64
    %41 = llvm.mlir.constant(1 : index) : i64
    %42 = llvm.mlir.constant(65536 : index) : i64
    %43 = llvm.mlir.zero : !llvm.ptr
    %44 = llvm.getelementptr %43[%42] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %45 = llvm.ptrtoint %44 : !llvm.ptr to i64
    %46 = llvm.mlir.constant(64 : index) : i64
    %47 = llvm.add %45, %46 : i64
    %48 = llvm.call @malloc(%47) : (i64) -> !llvm.ptr
    %49 = llvm.ptrtoint %48 : !llvm.ptr to i64
    %50 = llvm.mlir.constant(1 : index) : i64
    %51 = llvm.sub %46, %50 : i64
    %52 = llvm.add %49, %51 : i64
    %53 = llvm.urem %52, %46 : i64
    %54 = llvm.sub %52, %53 : i64
    %55 = llvm.inttoptr %54 : i64 to !llvm.ptr
    %56 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %57 = llvm.insertvalue %48, %56[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %58 = llvm.insertvalue %55, %57[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %59 = llvm.mlir.constant(0 : index) : i64
    %60 = llvm.insertvalue %59, %58[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %61 = llvm.insertvalue %39, %60[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %62 = llvm.insertvalue %40, %61[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %63 = llvm.insertvalue %40, %62[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %64 = llvm.insertvalue %41, %63[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %65 = builtin.unrealized_conversion_cast %64 : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> to memref<64x1024xf32>
    %66 = llvm.mlir.constant(64 : index) : i64
    %67 = llvm.mlir.constant(1024 : index) : i64
    %68 = llvm.mlir.constant(65536 : index) : i64
    %69 = llvm.mlir.constant(0 : index) : i64
    %70 = builtin.unrealized_conversion_cast %69 : i64 to index
    %71 = llvm.mlir.constant(65536 : index) : i64
    %72 = builtin.unrealized_conversion_cast %71 : i64 to index
    %73 = llvm.mlir.constant(1 : index) : i64
    %74 = builtin.unrealized_conversion_cast %73 : i64 to index
    scf.for %arg3 = %70 to %72 step %74 {
      %76 = builtin.unrealized_conversion_cast %arg3 : index to i64
      %77 = llvm.srem %76, %67 : i64
      %78 = llvm.mlir.constant(0 : index) : i64
      %79 = llvm.icmp "slt" %77, %78 : i64
      %80 = llvm.add %77, %67 : i64
      %81 = llvm.select %79, %80, %77 : i1, i64
      %82 = llvm.mlir.constant(0 : index) : i64
      %83 = llvm.mlir.constant(-1 : index) : i64
      %84 = llvm.icmp "slt" %76, %82 : i64
      %85 = llvm.sub %83, %76 : i64
      %86 = llvm.select %84, %85, %76 : i1, i64
      %87 = llvm.sdiv %86, %67 : i64
      %88 = llvm.sub %83, %87 : i64
      %89 = llvm.select %84, %88, %87 : i1, i64
      %90 = llvm.mlir.constant(0 : index) : i64
      %91 = builtin.unrealized_conversion_cast %90 : i64 to index
      %92 = llvm.mlir.constant(256 : index) : i64
      %93 = builtin.unrealized_conversion_cast %92 : i64 to index
      %94 = llvm.mlir.constant(1 : index) : i64
      %95 = builtin.unrealized_conversion_cast %94 : i64 to index
      scf.for %arg4 = %91 to %93 step %95 {
        %127 = builtin.unrealized_conversion_cast %arg4 : index to i64
        %128 = llvm.extractvalue %38[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %129 = llvm.extractvalue %38[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %130 = llvm.getelementptr %128[%129] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %131 = llvm.extractvalue %38[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %132 = llvm.mul %89, %131 overflow<nsw, nuw> : i64
        %133 = llvm.extractvalue %38[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %134 = llvm.mul %127, %133 overflow<nsw, nuw> : i64
        %135 = llvm.add %132, %134 overflow<nsw, nuw> : i64
        %136 = llvm.getelementptr inbounds|nuw %130[%135] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %137 = llvm.load %136 : !llvm.ptr -> f32
        %138 = llvm.extractvalue %36[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %139 = llvm.extractvalue %36[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %140 = llvm.getelementptr %138[%139] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %141 = llvm.extractvalue %36[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %142 = llvm.mul %127, %141 overflow<nsw, nuw> : i64
        %143 = llvm.extractvalue %36[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %144 = llvm.mul %81, %143 overflow<nsw, nuw> : i64
        %145 = llvm.add %142, %144 overflow<nsw, nuw> : i64
        %146 = llvm.getelementptr inbounds|nuw %140[%145] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %147 = llvm.load %146 : !llvm.ptr -> f32
        %148 = llvm.mlir.constant(0 : index) : i64
        %149 = llvm.mlir.constant(0 : index) : i64
        %150 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %151 = llvm.add %148, %149 overflow<nsw, nuw> : i64
        %152 = llvm.getelementptr inbounds|nuw %150[%151] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %153 = llvm.load %152 : !llvm.ptr -> f32
        %154 = llvm.fmul %137, %147 : f32
        %155 = llvm.fadd %153, %154 : f32
        %156 = llvm.mlir.constant(0 : index) : i64
        %157 = llvm.mlir.constant(0 : index) : i64
        %158 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %159 = llvm.add %156, %157 overflow<nsw, nuw> : i64
        %160 = llvm.getelementptr inbounds|nuw %158[%159] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        llvm.store %155, %160 : f32, !llvm.ptr
      }
      %96 = llvm.extractvalue %34[1] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %97 = llvm.extractvalue %34[2] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %98 = llvm.getelementptr %96[%97] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %99 = llvm.extractvalue %34[4, 0] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %100 = llvm.mul %81, %99 overflow<nsw, nuw> : i64
      %101 = llvm.getelementptr inbounds|nuw %98[%100] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %102 = llvm.load %101 : !llvm.ptr -> f32
      %103 = llvm.mlir.constant(0 : index) : i64
      %104 = llvm.mlir.constant(0 : index) : i64
      %105 = llvm.extractvalue %31[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %106 = llvm.add %103, %104 overflow<nsw, nuw> : i64
      %107 = llvm.getelementptr inbounds|nuw %105[%106] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %102, %107 : f32, !llvm.ptr
      %108 = llvm.mlir.constant(0 : index) : i64
      %109 = llvm.mlir.constant(0 : index) : i64
      %110 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %111 = llvm.add %108, %109 overflow<nsw, nuw> : i64
      %112 = llvm.getelementptr inbounds|nuw %110[%111] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %113 = llvm.load %112 : !llvm.ptr -> f32
      %114 = llvm.mlir.constant(0 : index) : i64
      %115 = llvm.mlir.constant(0 : index) : i64
      %116 = llvm.extractvalue %31[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %117 = llvm.add %114, %115 overflow<nsw, nuw> : i64
      %118 = llvm.getelementptr inbounds|nuw %116[%117] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %119 = llvm.load %118 : !llvm.ptr -> f32
      %120 = llvm.fadd %113, %119 : f32
      %121 = llvm.intr.maximum(%120, %32) : (f32, f32) -> f32
      %122 = llvm.extractvalue %64[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %123 = llvm.mlir.constant(1024 : index) : i64
      %124 = llvm.mul %89, %123 overflow<nsw, nuw> : i64
      %125 = llvm.add %124, %81 overflow<nsw, nuw> : i64
      %126 = llvm.getelementptr inbounds|nuw %122[%125] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %121, %126 : f32, !llvm.ptr
    }
    %75 = bufferization.to_tensor %65 : memref<64x1024xf32> to tensor<64x1024xf32>
    return %75 : tensor<64x1024xf32>
  }
  func.func @narrow_linear_layer_f32(%arg0: tensor<128x1024xf32>, %arg1: tensor<1024x64xf32>, %arg2: tensor<64xf32>) -> tensor<128x64xf32> {
    %0 = llvm.mlir.constant(1 : index) : i64
    %1 = llvm.mlir.constant(1 : index) : i64
    %2 = llvm.mlir.constant(1 : index) : i64
    %3 = llvm.mlir.zero : !llvm.ptr
    %4 = llvm.getelementptr %3[%0] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %5 = llvm.ptrtoint %4 : !llvm.ptr to i64
    %6 = llvm.call @malloc(%5) : (i64) -> !llvm.ptr
    %7 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %8 = llvm.insertvalue %6, %7[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %9 = llvm.insertvalue %6, %8[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %10 = llvm.mlir.constant(0 : index) : i64
    %11 = llvm.insertvalue %10, %9[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %12 = llvm.insertvalue %0, %11[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %13 = llvm.insertvalue %1, %12[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %14 = llvm.insertvalue %1, %13[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %15 = llvm.insertvalue %2, %14[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %16 = llvm.mlir.constant(1 : index) : i64
    %17 = llvm.mlir.constant(1 : index) : i64
    %18 = llvm.mlir.constant(1 : index) : i64
    %19 = llvm.mlir.zero : !llvm.ptr
    %20 = llvm.getelementptr %19[%16] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %21 = llvm.ptrtoint %20 : !llvm.ptr to i64
    %22 = llvm.call @malloc(%21) : (i64) -> !llvm.ptr
    %23 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %24 = llvm.insertvalue %22, %23[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %25 = llvm.insertvalue %22, %24[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %26 = llvm.mlir.constant(0 : index) : i64
    %27 = llvm.insertvalue %26, %25[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %28 = llvm.insertvalue %16, %27[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %29 = llvm.insertvalue %17, %28[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %30 = llvm.insertvalue %17, %29[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %31 = llvm.insertvalue %18, %30[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %32 = llvm.mlir.constant(0.000000e+00 : f32) : f32
    %33 = bufferization.to_buffer %arg2 : tensor<64xf32> to memref<64xf32, strided<[?], offset: ?>>
    %34 = builtin.unrealized_conversion_cast %33 : memref<64xf32, strided<[?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)>
    %35 = bufferization.to_buffer %arg1 : tensor<1024x64xf32> to memref<1024x64xf32, strided<[?, ?], offset: ?>>
    %36 = builtin.unrealized_conversion_cast %35 : memref<1024x64xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %37 = bufferization.to_buffer %arg0 : tensor<128x1024xf32> to memref<128x1024xf32, strided<[?, ?], offset: ?>>
    %38 = builtin.unrealized_conversion_cast %37 : memref<128x1024xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %39 = llvm.mlir.constant(128 : index) : i64
    %40 = llvm.mlir.constant(64 : index) : i64
    %41 = llvm.mlir.constant(1 : index) : i64
    %42 = llvm.mlir.constant(8192 : index) : i64
    %43 = llvm.mlir.zero : !llvm.ptr
    %44 = llvm.getelementptr %43[%42] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %45 = llvm.ptrtoint %44 : !llvm.ptr to i64
    %46 = llvm.mlir.constant(64 : index) : i64
    %47 = llvm.add %45, %46 : i64
    %48 = llvm.call @malloc(%47) : (i64) -> !llvm.ptr
    %49 = llvm.ptrtoint %48 : !llvm.ptr to i64
    %50 = llvm.mlir.constant(1 : index) : i64
    %51 = llvm.sub %46, %50 : i64
    %52 = llvm.add %49, %51 : i64
    %53 = llvm.urem %52, %46 : i64
    %54 = llvm.sub %52, %53 : i64
    %55 = llvm.inttoptr %54 : i64 to !llvm.ptr
    %56 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %57 = llvm.insertvalue %48, %56[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %58 = llvm.insertvalue %55, %57[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %59 = llvm.mlir.constant(0 : index) : i64
    %60 = llvm.insertvalue %59, %58[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %61 = llvm.insertvalue %39, %60[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %62 = llvm.insertvalue %40, %61[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %63 = llvm.insertvalue %40, %62[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %64 = llvm.insertvalue %41, %63[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %65 = builtin.unrealized_conversion_cast %64 : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> to memref<128x64xf32>
    %66 = llvm.mlir.constant(128 : index) : i64
    %67 = llvm.mlir.constant(64 : index) : i64
    %68 = llvm.mlir.constant(8192 : index) : i64
    %69 = llvm.mlir.constant(0 : index) : i64
    %70 = builtin.unrealized_conversion_cast %69 : i64 to index
    %71 = llvm.mlir.constant(8192 : index) : i64
    %72 = builtin.unrealized_conversion_cast %71 : i64 to index
    %73 = llvm.mlir.constant(1 : index) : i64
    %74 = builtin.unrealized_conversion_cast %73 : i64 to index
    scf.for %arg3 = %70 to %72 step %74 {
      %76 = builtin.unrealized_conversion_cast %arg3 : index to i64
      %77 = llvm.srem %76, %67 : i64
      %78 = llvm.mlir.constant(0 : index) : i64
      %79 = llvm.icmp "slt" %77, %78 : i64
      %80 = llvm.add %77, %67 : i64
      %81 = llvm.select %79, %80, %77 : i1, i64
      %82 = llvm.mlir.constant(0 : index) : i64
      %83 = llvm.mlir.constant(-1 : index) : i64
      %84 = llvm.icmp "slt" %76, %82 : i64
      %85 = llvm.sub %83, %76 : i64
      %86 = llvm.select %84, %85, %76 : i1, i64
      %87 = llvm.sdiv %86, %67 : i64
      %88 = llvm.sub %83, %87 : i64
      %89 = llvm.select %84, %88, %87 : i1, i64
      %90 = llvm.mlir.constant(0 : index) : i64
      %91 = builtin.unrealized_conversion_cast %90 : i64 to index
      %92 = llvm.mlir.constant(1024 : index) : i64
      %93 = builtin.unrealized_conversion_cast %92 : i64 to index
      %94 = llvm.mlir.constant(1 : index) : i64
      %95 = builtin.unrealized_conversion_cast %94 : i64 to index
      scf.for %arg4 = %91 to %93 step %95 {
        %127 = builtin.unrealized_conversion_cast %arg4 : index to i64
        %128 = llvm.extractvalue %38[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %129 = llvm.extractvalue %38[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %130 = llvm.getelementptr %128[%129] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %131 = llvm.extractvalue %38[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %132 = llvm.mul %89, %131 overflow<nsw, nuw> : i64
        %133 = llvm.extractvalue %38[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %134 = llvm.mul %127, %133 overflow<nsw, nuw> : i64
        %135 = llvm.add %132, %134 overflow<nsw, nuw> : i64
        %136 = llvm.getelementptr inbounds|nuw %130[%135] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %137 = llvm.load %136 : !llvm.ptr -> f32
        %138 = llvm.extractvalue %36[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %139 = llvm.extractvalue %36[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %140 = llvm.getelementptr %138[%139] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %141 = llvm.extractvalue %36[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %142 = llvm.mul %127, %141 overflow<nsw, nuw> : i64
        %143 = llvm.extractvalue %36[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %144 = llvm.mul %81, %143 overflow<nsw, nuw> : i64
        %145 = llvm.add %142, %144 overflow<nsw, nuw> : i64
        %146 = llvm.getelementptr inbounds|nuw %140[%145] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %147 = llvm.load %146 : !llvm.ptr -> f32
        %148 = llvm.mlir.constant(0 : index) : i64
        %149 = llvm.mlir.constant(0 : index) : i64
        %150 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %151 = llvm.add %148, %149 overflow<nsw, nuw> : i64
        %152 = llvm.getelementptr inbounds|nuw %150[%151] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %153 = llvm.load %152 : !llvm.ptr -> f32
        %154 = llvm.fmul %137, %147 : f32
        %155 = llvm.fadd %153, %154 : f32
        %156 = llvm.mlir.constant(0 : index) : i64
        %157 = llvm.mlir.constant(0 : index) : i64
        %158 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %159 = llvm.add %156, %157 overflow<nsw, nuw> : i64
        %160 = llvm.getelementptr inbounds|nuw %158[%159] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        llvm.store %155, %160 : f32, !llvm.ptr
      }
      %96 = llvm.extractvalue %34[1] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %97 = llvm.extractvalue %34[2] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %98 = llvm.getelementptr %96[%97] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %99 = llvm.extractvalue %34[4, 0] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %100 = llvm.mul %81, %99 overflow<nsw, nuw> : i64
      %101 = llvm.getelementptr inbounds|nuw %98[%100] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %102 = llvm.load %101 : !llvm.ptr -> f32
      %103 = llvm.mlir.constant(0 : index) : i64
      %104 = llvm.mlir.constant(0 : index) : i64
      %105 = llvm.extractvalue %31[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %106 = llvm.add %103, %104 overflow<nsw, nuw> : i64
      %107 = llvm.getelementptr inbounds|nuw %105[%106] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %102, %107 : f32, !llvm.ptr
      %108 = llvm.mlir.constant(0 : index) : i64
      %109 = llvm.mlir.constant(0 : index) : i64
      %110 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %111 = llvm.add %108, %109 overflow<nsw, nuw> : i64
      %112 = llvm.getelementptr inbounds|nuw %110[%111] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %113 = llvm.load %112 : !llvm.ptr -> f32
      %114 = llvm.mlir.constant(0 : index) : i64
      %115 = llvm.mlir.constant(0 : index) : i64
      %116 = llvm.extractvalue %31[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %117 = llvm.add %114, %115 overflow<nsw, nuw> : i64
      %118 = llvm.getelementptr inbounds|nuw %116[%117] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %119 = llvm.load %118 : !llvm.ptr -> f32
      %120 = llvm.fadd %113, %119 : f32
      %121 = llvm.intr.maximum(%120, %32) : (f32, f32) -> f32
      %122 = llvm.extractvalue %64[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %123 = llvm.mlir.constant(64 : index) : i64
      %124 = llvm.mul %89, %123 overflow<nsw, nuw> : i64
      %125 = llvm.add %124, %81 overflow<nsw, nuw> : i64
      %126 = llvm.getelementptr inbounds|nuw %122[%125] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %121, %126 : f32, !llvm.ptr
    }
    %75 = bufferization.to_tensor %65 : memref<128x64xf32> to tensor<128x64xf32>
    return %75 : tensor<128x64xf32>
  }
  func.func @multi_layer_network(%arg0: tensor<32x128xf32>, %arg1: tensor<128x256xf32>, %arg2: tensor<256xf32>, %arg3: tensor<256x128xf32>, %arg4: tensor<128xf32>, %arg5: tensor<128x10xf32>, %arg6: tensor<10xf32>) -> tensor<32x10xf32> {
    %0 = llvm.mlir.constant(1 : index) : i64
    %1 = llvm.mlir.constant(128 : index) : i64
    %2 = llvm.mlir.constant(1 : index) : i64
    %3 = llvm.mlir.constant(128 : index) : i64
    %4 = llvm.mlir.zero : !llvm.ptr
    %5 = llvm.getelementptr %4[%3] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %6 = llvm.ptrtoint %5 : !llvm.ptr to i64
    %7 = llvm.call @malloc(%6) : (i64) -> !llvm.ptr
    %8 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %9 = llvm.insertvalue %7, %8[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %10 = llvm.insertvalue %7, %9[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %11 = llvm.mlir.constant(0 : index) : i64
    %12 = llvm.insertvalue %11, %10[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %13 = llvm.insertvalue %0, %12[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %14 = llvm.insertvalue %1, %13[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %15 = llvm.insertvalue %1, %14[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %16 = llvm.insertvalue %2, %15[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %17 = llvm.mlir.constant(1 : index) : i64
    %18 = llvm.mlir.constant(1 : index) : i64
    %19 = llvm.mlir.constant(1 : index) : i64
    %20 = llvm.mlir.zero : !llvm.ptr
    %21 = llvm.getelementptr %20[%17] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %22 = llvm.ptrtoint %21 : !llvm.ptr to i64
    %23 = llvm.call @malloc(%22) : (i64) -> !llvm.ptr
    %24 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %25 = llvm.insertvalue %23, %24[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %26 = llvm.insertvalue %23, %25[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %27 = llvm.mlir.constant(0 : index) : i64
    %28 = llvm.insertvalue %27, %26[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %29 = llvm.insertvalue %17, %28[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %30 = llvm.insertvalue %18, %29[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %31 = llvm.insertvalue %18, %30[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %32 = llvm.insertvalue %19, %31[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %33 = llvm.mlir.constant(1 : index) : i64
    %34 = llvm.mlir.constant(1 : index) : i64
    %35 = llvm.mlir.constant(1 : index) : i64
    %36 = llvm.mlir.zero : !llvm.ptr
    %37 = llvm.getelementptr %36[%33] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %38 = llvm.ptrtoint %37 : !llvm.ptr to i64
    %39 = llvm.call @malloc(%38) : (i64) -> !llvm.ptr
    %40 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %41 = llvm.insertvalue %39, %40[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %42 = llvm.insertvalue %39, %41[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %43 = llvm.mlir.constant(0 : index) : i64
    %44 = llvm.insertvalue %43, %42[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %45 = llvm.insertvalue %33, %44[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %46 = llvm.insertvalue %34, %45[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %47 = llvm.insertvalue %34, %46[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %48 = llvm.insertvalue %35, %47[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %49 = llvm.mlir.constant(1 : index) : i64
    %50 = llvm.mlir.constant(1 : index) : i64
    %51 = llvm.mlir.constant(1 : index) : i64
    %52 = llvm.mlir.zero : !llvm.ptr
    %53 = llvm.getelementptr %52[%49] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %54 = llvm.ptrtoint %53 : !llvm.ptr to i64
    %55 = llvm.call @malloc(%54) : (i64) -> !llvm.ptr
    %56 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %57 = llvm.insertvalue %55, %56[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %58 = llvm.insertvalue %55, %57[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %59 = llvm.mlir.constant(0 : index) : i64
    %60 = llvm.insertvalue %59, %58[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %61 = llvm.insertvalue %49, %60[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %62 = llvm.insertvalue %50, %61[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %63 = llvm.insertvalue %50, %62[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %64 = llvm.insertvalue %51, %63[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %65 = llvm.mlir.constant(1 : index) : i64
    %66 = llvm.mlir.constant(1 : index) : i64
    %67 = llvm.mlir.constant(1 : index) : i64
    %68 = llvm.mlir.zero : !llvm.ptr
    %69 = llvm.getelementptr %68[%65] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %70 = llvm.ptrtoint %69 : !llvm.ptr to i64
    %71 = llvm.call @malloc(%70) : (i64) -> !llvm.ptr
    %72 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %73 = llvm.insertvalue %71, %72[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %74 = llvm.insertvalue %71, %73[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %75 = llvm.mlir.constant(0 : index) : i64
    %76 = llvm.insertvalue %75, %74[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %77 = llvm.insertvalue %65, %76[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %78 = llvm.insertvalue %66, %77[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %79 = llvm.insertvalue %66, %78[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %80 = llvm.insertvalue %67, %79[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %81 = llvm.mlir.constant(1 : index) : i64
    %82 = llvm.mlir.constant(256 : index) : i64
    %83 = llvm.mlir.constant(1 : index) : i64
    %84 = llvm.mlir.constant(256 : index) : i64
    %85 = llvm.mlir.zero : !llvm.ptr
    %86 = llvm.getelementptr %85[%84] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %87 = llvm.ptrtoint %86 : !llvm.ptr to i64
    %88 = llvm.call @malloc(%87) : (i64) -> !llvm.ptr
    %89 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %90 = llvm.insertvalue %88, %89[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %91 = llvm.insertvalue %88, %90[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %92 = llvm.mlir.constant(0 : index) : i64
    %93 = llvm.insertvalue %92, %91[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %94 = llvm.insertvalue %81, %93[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %95 = llvm.insertvalue %82, %94[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %96 = llvm.insertvalue %82, %95[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %97 = llvm.insertvalue %83, %96[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %98 = llvm.mlir.constant(1 : index) : i64
    %99 = llvm.mlir.constant(1 : index) : i64
    %100 = llvm.mlir.constant(1 : index) : i64
    %101 = llvm.mlir.zero : !llvm.ptr
    %102 = llvm.getelementptr %101[%98] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %103 = llvm.ptrtoint %102 : !llvm.ptr to i64
    %104 = llvm.call @malloc(%103) : (i64) -> !llvm.ptr
    %105 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %106 = llvm.insertvalue %104, %105[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %107 = llvm.insertvalue %104, %106[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %108 = llvm.mlir.constant(0 : index) : i64
    %109 = llvm.insertvalue %108, %107[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %110 = llvm.insertvalue %98, %109[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %111 = llvm.insertvalue %99, %110[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %112 = llvm.insertvalue %99, %111[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %113 = llvm.insertvalue %100, %112[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %114 = llvm.mlir.constant(1 : index) : i64
    %115 = llvm.mlir.constant(1 : index) : i64
    %116 = llvm.mlir.constant(1 : index) : i64
    %117 = llvm.mlir.zero : !llvm.ptr
    %118 = llvm.getelementptr %117[%114] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %119 = llvm.ptrtoint %118 : !llvm.ptr to i64
    %120 = llvm.call @malloc(%119) : (i64) -> !llvm.ptr
    %121 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %122 = llvm.insertvalue %120, %121[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %123 = llvm.insertvalue %120, %122[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %124 = llvm.mlir.constant(0 : index) : i64
    %125 = llvm.insertvalue %124, %123[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %126 = llvm.insertvalue %114, %125[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %127 = llvm.insertvalue %115, %126[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %128 = llvm.insertvalue %115, %127[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %129 = llvm.insertvalue %116, %128[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %130 = llvm.mlir.constant(0.000000e+00 : f32) : f32
    %131 = bufferization.to_buffer %arg6 : tensor<10xf32> to memref<10xf32, strided<[?], offset: ?>>
    %132 = builtin.unrealized_conversion_cast %131 : memref<10xf32, strided<[?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)>
    %133 = bufferization.to_buffer %arg5 : tensor<128x10xf32> to memref<128x10xf32, strided<[?, ?], offset: ?>>
    %134 = builtin.unrealized_conversion_cast %133 : memref<128x10xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %135 = bufferization.to_buffer %arg4 : tensor<128xf32> to memref<128xf32, strided<[?], offset: ?>>
    %136 = builtin.unrealized_conversion_cast %135 : memref<128xf32, strided<[?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)>
    %137 = bufferization.to_buffer %arg3 : tensor<256x128xf32> to memref<256x128xf32, strided<[?, ?], offset: ?>>
    %138 = builtin.unrealized_conversion_cast %137 : memref<256x128xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %139 = bufferization.to_buffer %arg2 : tensor<256xf32> to memref<256xf32, strided<[?], offset: ?>>
    %140 = builtin.unrealized_conversion_cast %139 : memref<256xf32, strided<[?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)>
    %141 = bufferization.to_buffer %arg1 : tensor<128x256xf32> to memref<128x256xf32, strided<[?, ?], offset: ?>>
    %142 = builtin.unrealized_conversion_cast %141 : memref<128x256xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %143 = bufferization.to_buffer %arg0 : tensor<32x128xf32> to memref<32x128xf32, strided<[?, ?], offset: ?>>
    %144 = builtin.unrealized_conversion_cast %143 : memref<32x128xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %145 = llvm.mlir.constant(32 : index) : i64
    %146 = llvm.mlir.constant(10 : index) : i64
    %147 = llvm.mlir.constant(1 : index) : i64
    %148 = llvm.mlir.constant(320 : index) : i64
    %149 = llvm.mlir.zero : !llvm.ptr
    %150 = llvm.getelementptr %149[%148] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %151 = llvm.ptrtoint %150 : !llvm.ptr to i64
    %152 = llvm.mlir.constant(64 : index) : i64
    %153 = llvm.add %151, %152 : i64
    %154 = llvm.call @malloc(%153) : (i64) -> !llvm.ptr
    %155 = llvm.ptrtoint %154 : !llvm.ptr to i64
    %156 = llvm.mlir.constant(1 : index) : i64
    %157 = llvm.sub %152, %156 : i64
    %158 = llvm.add %155, %157 : i64
    %159 = llvm.urem %158, %152 : i64
    %160 = llvm.sub %158, %159 : i64
    %161 = llvm.inttoptr %160 : i64 to !llvm.ptr
    %162 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %163 = llvm.insertvalue %154, %162[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %164 = llvm.insertvalue %161, %163[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %165 = llvm.mlir.constant(0 : index) : i64
    %166 = llvm.insertvalue %165, %164[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %167 = llvm.insertvalue %145, %166[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %168 = llvm.insertvalue %146, %167[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %169 = llvm.insertvalue %146, %168[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %170 = llvm.insertvalue %147, %169[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %171 = builtin.unrealized_conversion_cast %170 : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> to memref<32x10xf32>
    %172 = llvm.mlir.constant(0 : index) : i64
    %173 = builtin.unrealized_conversion_cast %172 : i64 to index
    %174 = llvm.mlir.constant(32 : index) : i64
    %175 = builtin.unrealized_conversion_cast %174 : i64 to index
    %176 = llvm.mlir.constant(1 : index) : i64
    %177 = builtin.unrealized_conversion_cast %176 : i64 to index
    scf.for %arg7 = %173 to %175 step %177 {
      %179 = builtin.unrealized_conversion_cast %arg7 : index to i64
      %180 = llvm.mlir.constant(0 : index) : i64
      %181 = builtin.unrealized_conversion_cast %180 : i64 to index
      %182 = llvm.mlir.constant(256 : index) : i64
      %183 = builtin.unrealized_conversion_cast %182 : i64 to index
      %184 = llvm.mlir.constant(1 : index) : i64
      %185 = builtin.unrealized_conversion_cast %184 : i64 to index
      scf.for %arg8 = %181 to %183 step %185 {
        %198 = builtin.unrealized_conversion_cast %arg8 : index to i64
        %199 = llvm.mlir.constant(0 : index) : i64
        %200 = builtin.unrealized_conversion_cast %199 : i64 to index
        %201 = llvm.mlir.constant(128 : index) : i64
        %202 = builtin.unrealized_conversion_cast %201 : i64 to index
        %203 = llvm.mlir.constant(1 : index) : i64
        %204 = builtin.unrealized_conversion_cast %203 : i64 to index
        scf.for %arg9 = %200 to %202 step %204 {
          %237 = builtin.unrealized_conversion_cast %arg9 : index to i64
          %238 = llvm.extractvalue %144[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %239 = llvm.extractvalue %144[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %240 = llvm.getelementptr %238[%239] : (!llvm.ptr, i64) -> !llvm.ptr, f32
          %241 = llvm.extractvalue %144[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %242 = llvm.mul %179, %241 overflow<nsw, nuw> : i64
          %243 = llvm.extractvalue %144[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %244 = llvm.mul %237, %243 overflow<nsw, nuw> : i64
          %245 = llvm.add %242, %244 overflow<nsw, nuw> : i64
          %246 = llvm.getelementptr inbounds|nuw %240[%245] : (!llvm.ptr, i64) -> !llvm.ptr, f32
          %247 = llvm.load %246 : !llvm.ptr -> f32
          %248 = llvm.extractvalue %142[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %249 = llvm.extractvalue %142[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %250 = llvm.getelementptr %248[%249] : (!llvm.ptr, i64) -> !llvm.ptr, f32
          %251 = llvm.extractvalue %142[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %252 = llvm.mul %237, %251 overflow<nsw, nuw> : i64
          %253 = llvm.extractvalue %142[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %254 = llvm.mul %198, %253 overflow<nsw, nuw> : i64
          %255 = llvm.add %252, %254 overflow<nsw, nuw> : i64
          %256 = llvm.getelementptr inbounds|nuw %250[%255] : (!llvm.ptr, i64) -> !llvm.ptr, f32
          %257 = llvm.load %256 : !llvm.ptr -> f32
          %258 = llvm.mlir.constant(0 : index) : i64
          %259 = llvm.mlir.constant(0 : index) : i64
          %260 = llvm.extractvalue %64[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %261 = llvm.add %258, %259 overflow<nsw, nuw> : i64
          %262 = llvm.getelementptr inbounds|nuw %260[%261] : (!llvm.ptr, i64) -> !llvm.ptr, f32
          %263 = llvm.load %262 : !llvm.ptr -> f32
          %264 = llvm.fmul %247, %257 : f32
          %265 = llvm.fadd %263, %264 : f32
          %266 = llvm.mlir.constant(0 : index) : i64
          %267 = llvm.mlir.constant(0 : index) : i64
          %268 = llvm.extractvalue %64[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %269 = llvm.add %266, %267 overflow<nsw, nuw> : i64
          %270 = llvm.getelementptr inbounds|nuw %268[%269] : (!llvm.ptr, i64) -> !llvm.ptr, f32
          llvm.store %265, %270 : f32, !llvm.ptr
        }
        %205 = llvm.extractvalue %140[1] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
        %206 = llvm.extractvalue %140[2] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
        %207 = llvm.getelementptr %205[%206] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %208 = llvm.extractvalue %140[4, 0] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
        %209 = llvm.mul %198, %208 overflow<nsw, nuw> : i64
        %210 = llvm.getelementptr inbounds|nuw %207[%209] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %211 = llvm.load %210 : !llvm.ptr -> f32
        %212 = llvm.mlir.constant(0 : index) : i64
        %213 = llvm.mlir.constant(0 : index) : i64
        %214 = llvm.extractvalue %80[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %215 = llvm.add %212, %213 overflow<nsw, nuw> : i64
        %216 = llvm.getelementptr inbounds|nuw %214[%215] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        llvm.store %211, %216 : f32, !llvm.ptr
        %217 = llvm.mlir.constant(0 : index) : i64
        %218 = llvm.mlir.constant(0 : index) : i64
        %219 = llvm.extractvalue %64[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %220 = llvm.add %217, %218 overflow<nsw, nuw> : i64
        %221 = llvm.getelementptr inbounds|nuw %219[%220] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %222 = llvm.load %221 : !llvm.ptr -> f32
        %223 = llvm.mlir.constant(0 : index) : i64
        %224 = llvm.mlir.constant(0 : index) : i64
        %225 = llvm.extractvalue %80[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %226 = llvm.add %223, %224 overflow<nsw, nuw> : i64
        %227 = llvm.getelementptr inbounds|nuw %225[%226] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %228 = llvm.load %227 : !llvm.ptr -> f32
        %229 = llvm.fadd %222, %228 : f32
        %230 = llvm.intr.maximum(%229, %130) : (f32, f32) -> f32
        %231 = llvm.mlir.constant(0 : index) : i64
        %232 = llvm.extractvalue %97[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %233 = llvm.mlir.constant(256 : index) : i64
        %234 = llvm.mul %231, %233 overflow<nsw, nuw> : i64
        %235 = llvm.add %234, %198 overflow<nsw, nuw> : i64
        %236 = llvm.getelementptr inbounds|nuw %232[%235] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        llvm.store %230, %236 : f32, !llvm.ptr
      }
      %186 = llvm.mlir.constant(0 : index) : i64
      %187 = builtin.unrealized_conversion_cast %186 : i64 to index
      %188 = llvm.mlir.constant(128 : index) : i64
      %189 = builtin.unrealized_conversion_cast %188 : i64 to index
      %190 = llvm.mlir.constant(1 : index) : i64
      %191 = builtin.unrealized_conversion_cast %190 : i64 to index
      scf.for %arg8 = %187 to %189 step %191 {
        %198 = builtin.unrealized_conversion_cast %arg8 : index to i64
        %199 = llvm.mlir.constant(0 : index) : i64
        %200 = builtin.unrealized_conversion_cast %199 : i64 to index
        %201 = llvm.mlir.constant(256 : index) : i64
        %202 = builtin.unrealized_conversion_cast %201 : i64 to index
        %203 = llvm.mlir.constant(1 : index) : i64
        %204 = builtin.unrealized_conversion_cast %203 : i64 to index
        scf.for %arg9 = %200 to %202 step %204 {
          %237 = builtin.unrealized_conversion_cast %arg9 : index to i64
          %238 = llvm.mlir.constant(0 : index) : i64
          %239 = llvm.extractvalue %97[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %240 = llvm.mlir.constant(256 : index) : i64
          %241 = llvm.mul %238, %240 overflow<nsw, nuw> : i64
          %242 = llvm.add %241, %237 overflow<nsw, nuw> : i64
          %243 = llvm.getelementptr inbounds|nuw %239[%242] : (!llvm.ptr, i64) -> !llvm.ptr, f32
          %244 = llvm.load %243 : !llvm.ptr -> f32
          %245 = llvm.extractvalue %138[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %246 = llvm.extractvalue %138[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %247 = llvm.getelementptr %245[%246] : (!llvm.ptr, i64) -> !llvm.ptr, f32
          %248 = llvm.extractvalue %138[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %249 = llvm.mul %237, %248 overflow<nsw, nuw> : i64
          %250 = llvm.extractvalue %138[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %251 = llvm.mul %198, %250 overflow<nsw, nuw> : i64
          %252 = llvm.add %249, %251 overflow<nsw, nuw> : i64
          %253 = llvm.getelementptr inbounds|nuw %247[%252] : (!llvm.ptr, i64) -> !llvm.ptr, f32
          %254 = llvm.load %253 : !llvm.ptr -> f32
          %255 = llvm.mlir.constant(0 : index) : i64
          %256 = llvm.mlir.constant(0 : index) : i64
          %257 = llvm.extractvalue %113[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %258 = llvm.add %255, %256 overflow<nsw, nuw> : i64
          %259 = llvm.getelementptr inbounds|nuw %257[%258] : (!llvm.ptr, i64) -> !llvm.ptr, f32
          %260 = llvm.load %259 : !llvm.ptr -> f32
          %261 = llvm.fmul %244, %254 : f32
          %262 = llvm.fadd %260, %261 : f32
          %263 = llvm.mlir.constant(0 : index) : i64
          %264 = llvm.mlir.constant(0 : index) : i64
          %265 = llvm.extractvalue %113[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %266 = llvm.add %263, %264 overflow<nsw, nuw> : i64
          %267 = llvm.getelementptr inbounds|nuw %265[%266] : (!llvm.ptr, i64) -> !llvm.ptr, f32
          llvm.store %262, %267 : f32, !llvm.ptr
        }
        %205 = llvm.extractvalue %136[1] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
        %206 = llvm.extractvalue %136[2] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
        %207 = llvm.getelementptr %205[%206] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %208 = llvm.extractvalue %136[4, 0] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
        %209 = llvm.mul %198, %208 overflow<nsw, nuw> : i64
        %210 = llvm.getelementptr inbounds|nuw %207[%209] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %211 = llvm.load %210 : !llvm.ptr -> f32
        %212 = llvm.mlir.constant(0 : index) : i64
        %213 = llvm.mlir.constant(0 : index) : i64
        %214 = llvm.extractvalue %129[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %215 = llvm.add %212, %213 overflow<nsw, nuw> : i64
        %216 = llvm.getelementptr inbounds|nuw %214[%215] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        llvm.store %211, %216 : f32, !llvm.ptr
        %217 = llvm.mlir.constant(0 : index) : i64
        %218 = llvm.mlir.constant(0 : index) : i64
        %219 = llvm.extractvalue %113[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %220 = llvm.add %217, %218 overflow<nsw, nuw> : i64
        %221 = llvm.getelementptr inbounds|nuw %219[%220] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %222 = llvm.load %221 : !llvm.ptr -> f32
        %223 = llvm.mlir.constant(0 : index) : i64
        %224 = llvm.mlir.constant(0 : index) : i64
        %225 = llvm.extractvalue %129[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %226 = llvm.add %223, %224 overflow<nsw, nuw> : i64
        %227 = llvm.getelementptr inbounds|nuw %225[%226] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %228 = llvm.load %227 : !llvm.ptr -> f32
        %229 = llvm.fadd %222, %228 : f32
        %230 = llvm.intr.maximum(%229, %130) : (f32, f32) -> f32
        %231 = llvm.mlir.constant(0 : index) : i64
        %232 = llvm.extractvalue %16[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %233 = llvm.mlir.constant(128 : index) : i64
        %234 = llvm.mul %231, %233 overflow<nsw, nuw> : i64
        %235 = llvm.add %234, %198 overflow<nsw, nuw> : i64
        %236 = llvm.getelementptr inbounds|nuw %232[%235] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        llvm.store %230, %236 : f32, !llvm.ptr
      }
      %192 = llvm.mlir.constant(0 : index) : i64
      %193 = builtin.unrealized_conversion_cast %192 : i64 to index
      %194 = llvm.mlir.constant(10 : index) : i64
      %195 = builtin.unrealized_conversion_cast %194 : i64 to index
      %196 = llvm.mlir.constant(1 : index) : i64
      %197 = builtin.unrealized_conversion_cast %196 : i64 to index
      scf.for %arg8 = %193 to %195 step %197 {
        %198 = builtin.unrealized_conversion_cast %arg8 : index to i64
        %199 = llvm.mlir.constant(0 : index) : i64
        %200 = builtin.unrealized_conversion_cast %199 : i64 to index
        %201 = llvm.mlir.constant(128 : index) : i64
        %202 = builtin.unrealized_conversion_cast %201 : i64 to index
        %203 = llvm.mlir.constant(1 : index) : i64
        %204 = builtin.unrealized_conversion_cast %203 : i64 to index
        scf.for %arg9 = %200 to %202 step %204 {
          %235 = builtin.unrealized_conversion_cast %arg9 : index to i64
          %236 = llvm.mlir.constant(0 : index) : i64
          %237 = llvm.extractvalue %16[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %238 = llvm.mlir.constant(128 : index) : i64
          %239 = llvm.mul %236, %238 overflow<nsw, nuw> : i64
          %240 = llvm.add %239, %235 overflow<nsw, nuw> : i64
          %241 = llvm.getelementptr inbounds|nuw %237[%240] : (!llvm.ptr, i64) -> !llvm.ptr, f32
          %242 = llvm.load %241 : !llvm.ptr -> f32
          %243 = llvm.extractvalue %134[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %244 = llvm.extractvalue %134[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %245 = llvm.getelementptr %243[%244] : (!llvm.ptr, i64) -> !llvm.ptr, f32
          %246 = llvm.extractvalue %134[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %247 = llvm.mul %235, %246 overflow<nsw, nuw> : i64
          %248 = llvm.extractvalue %134[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %249 = llvm.mul %198, %248 overflow<nsw, nuw> : i64
          %250 = llvm.add %247, %249 overflow<nsw, nuw> : i64
          %251 = llvm.getelementptr inbounds|nuw %245[%250] : (!llvm.ptr, i64) -> !llvm.ptr, f32
          %252 = llvm.load %251 : !llvm.ptr -> f32
          %253 = llvm.mlir.constant(0 : index) : i64
          %254 = llvm.mlir.constant(0 : index) : i64
          %255 = llvm.extractvalue %32[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %256 = llvm.add %253, %254 overflow<nsw, nuw> : i64
          %257 = llvm.getelementptr inbounds|nuw %255[%256] : (!llvm.ptr, i64) -> !llvm.ptr, f32
          %258 = llvm.load %257 : !llvm.ptr -> f32
          %259 = llvm.fmul %242, %252 : f32
          %260 = llvm.fadd %258, %259 : f32
          %261 = llvm.mlir.constant(0 : index) : i64
          %262 = llvm.mlir.constant(0 : index) : i64
          %263 = llvm.extractvalue %32[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
          %264 = llvm.add %261, %262 overflow<nsw, nuw> : i64
          %265 = llvm.getelementptr inbounds|nuw %263[%264] : (!llvm.ptr, i64) -> !llvm.ptr, f32
          llvm.store %260, %265 : f32, !llvm.ptr
        }
        %205 = llvm.extractvalue %132[1] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
        %206 = llvm.extractvalue %132[2] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
        %207 = llvm.getelementptr %205[%206] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %208 = llvm.extractvalue %132[4, 0] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
        %209 = llvm.mul %198, %208 overflow<nsw, nuw> : i64
        %210 = llvm.getelementptr inbounds|nuw %207[%209] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %211 = llvm.load %210 : !llvm.ptr -> f32
        %212 = llvm.mlir.constant(0 : index) : i64
        %213 = llvm.mlir.constant(0 : index) : i64
        %214 = llvm.extractvalue %48[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %215 = llvm.add %212, %213 overflow<nsw, nuw> : i64
        %216 = llvm.getelementptr inbounds|nuw %214[%215] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        llvm.store %211, %216 : f32, !llvm.ptr
        %217 = llvm.mlir.constant(0 : index) : i64
        %218 = llvm.mlir.constant(0 : index) : i64
        %219 = llvm.extractvalue %32[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %220 = llvm.add %217, %218 overflow<nsw, nuw> : i64
        %221 = llvm.getelementptr inbounds|nuw %219[%220] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %222 = llvm.load %221 : !llvm.ptr -> f32
        %223 = llvm.mlir.constant(0 : index) : i64
        %224 = llvm.mlir.constant(0 : index) : i64
        %225 = llvm.extractvalue %48[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %226 = llvm.add %223, %224 overflow<nsw, nuw> : i64
        %227 = llvm.getelementptr inbounds|nuw %225[%226] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %228 = llvm.load %227 : !llvm.ptr -> f32
        %229 = llvm.fadd %222, %228 : f32
        %230 = llvm.extractvalue %170[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %231 = llvm.mlir.constant(10 : index) : i64
        %232 = llvm.mul %179, %231 overflow<nsw, nuw> : i64
        %233 = llvm.add %232, %198 overflow<nsw, nuw> : i64
        %234 = llvm.getelementptr inbounds|nuw %230[%233] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        llvm.store %229, %234 : f32, !llvm.ptr
      }
    }
    %178 = bufferization.to_tensor %171 : memref<32x10xf32> to tensor<32x10xf32>
    return %178 : tensor<32x10xf32>
  }
  func.func @irregular_linear_layer(%arg0: tensor<17x97xf32>, %arg1: tensor<97x53xf32>, %arg2: tensor<53xf32>) -> tensor<17x53xf32> {
    %0 = llvm.mlir.constant(1 : index) : i64
    %1 = llvm.mlir.constant(1 : index) : i64
    %2 = llvm.mlir.constant(1 : index) : i64
    %3 = llvm.mlir.zero : !llvm.ptr
    %4 = llvm.getelementptr %3[%0] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %5 = llvm.ptrtoint %4 : !llvm.ptr to i64
    %6 = llvm.call @malloc(%5) : (i64) -> !llvm.ptr
    %7 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %8 = llvm.insertvalue %6, %7[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %9 = llvm.insertvalue %6, %8[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %10 = llvm.mlir.constant(0 : index) : i64
    %11 = llvm.insertvalue %10, %9[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %12 = llvm.insertvalue %0, %11[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %13 = llvm.insertvalue %1, %12[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %14 = llvm.insertvalue %1, %13[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %15 = llvm.insertvalue %2, %14[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %16 = llvm.mlir.constant(1 : index) : i64
    %17 = llvm.mlir.constant(1 : index) : i64
    %18 = llvm.mlir.constant(1 : index) : i64
    %19 = llvm.mlir.zero : !llvm.ptr
    %20 = llvm.getelementptr %19[%16] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %21 = llvm.ptrtoint %20 : !llvm.ptr to i64
    %22 = llvm.call @malloc(%21) : (i64) -> !llvm.ptr
    %23 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %24 = llvm.insertvalue %22, %23[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %25 = llvm.insertvalue %22, %24[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %26 = llvm.mlir.constant(0 : index) : i64
    %27 = llvm.insertvalue %26, %25[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %28 = llvm.insertvalue %16, %27[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %29 = llvm.insertvalue %17, %28[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %30 = llvm.insertvalue %17, %29[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %31 = llvm.insertvalue %18, %30[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %32 = llvm.mlir.constant(0.000000e+00 : f32) : f32
    %33 = bufferization.to_buffer %arg2 : tensor<53xf32> to memref<53xf32, strided<[?], offset: ?>>
    %34 = builtin.unrealized_conversion_cast %33 : memref<53xf32, strided<[?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)>
    %35 = bufferization.to_buffer %arg1 : tensor<97x53xf32> to memref<97x53xf32, strided<[?, ?], offset: ?>>
    %36 = builtin.unrealized_conversion_cast %35 : memref<97x53xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %37 = bufferization.to_buffer %arg0 : tensor<17x97xf32> to memref<17x97xf32, strided<[?, ?], offset: ?>>
    %38 = builtin.unrealized_conversion_cast %37 : memref<17x97xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %39 = llvm.mlir.constant(17 : index) : i64
    %40 = llvm.mlir.constant(53 : index) : i64
    %41 = llvm.mlir.constant(1 : index) : i64
    %42 = llvm.mlir.constant(901 : index) : i64
    %43 = llvm.mlir.zero : !llvm.ptr
    %44 = llvm.getelementptr %43[%42] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %45 = llvm.ptrtoint %44 : !llvm.ptr to i64
    %46 = llvm.mlir.constant(64 : index) : i64
    %47 = llvm.add %45, %46 : i64
    %48 = llvm.call @malloc(%47) : (i64) -> !llvm.ptr
    %49 = llvm.ptrtoint %48 : !llvm.ptr to i64
    %50 = llvm.mlir.constant(1 : index) : i64
    %51 = llvm.sub %46, %50 : i64
    %52 = llvm.add %49, %51 : i64
    %53 = llvm.urem %52, %46 : i64
    %54 = llvm.sub %52, %53 : i64
    %55 = llvm.inttoptr %54 : i64 to !llvm.ptr
    %56 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %57 = llvm.insertvalue %48, %56[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %58 = llvm.insertvalue %55, %57[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %59 = llvm.mlir.constant(0 : index) : i64
    %60 = llvm.insertvalue %59, %58[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %61 = llvm.insertvalue %39, %60[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %62 = llvm.insertvalue %40, %61[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %63 = llvm.insertvalue %40, %62[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %64 = llvm.insertvalue %41, %63[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %65 = builtin.unrealized_conversion_cast %64 : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> to memref<17x53xf32>
    %66 = llvm.mlir.constant(17 : index) : i64
    %67 = llvm.mlir.constant(53 : index) : i64
    %68 = llvm.mlir.constant(901 : index) : i64
    %69 = llvm.mlir.constant(0 : index) : i64
    %70 = builtin.unrealized_conversion_cast %69 : i64 to index
    %71 = llvm.mlir.constant(901 : index) : i64
    %72 = builtin.unrealized_conversion_cast %71 : i64 to index
    %73 = llvm.mlir.constant(1 : index) : i64
    %74 = builtin.unrealized_conversion_cast %73 : i64 to index
    scf.for %arg3 = %70 to %72 step %74 {
      %76 = builtin.unrealized_conversion_cast %arg3 : index to i64
      %77 = llvm.srem %76, %67 : i64
      %78 = llvm.mlir.constant(0 : index) : i64
      %79 = llvm.icmp "slt" %77, %78 : i64
      %80 = llvm.add %77, %67 : i64
      %81 = llvm.select %79, %80, %77 : i1, i64
      %82 = llvm.mlir.constant(0 : index) : i64
      %83 = llvm.mlir.constant(-1 : index) : i64
      %84 = llvm.icmp "slt" %76, %82 : i64
      %85 = llvm.sub %83, %76 : i64
      %86 = llvm.select %84, %85, %76 : i1, i64
      %87 = llvm.sdiv %86, %67 : i64
      %88 = llvm.sub %83, %87 : i64
      %89 = llvm.select %84, %88, %87 : i1, i64
      %90 = llvm.mlir.constant(0 : index) : i64
      %91 = builtin.unrealized_conversion_cast %90 : i64 to index
      %92 = llvm.mlir.constant(97 : index) : i64
      %93 = builtin.unrealized_conversion_cast %92 : i64 to index
      %94 = llvm.mlir.constant(1 : index) : i64
      %95 = builtin.unrealized_conversion_cast %94 : i64 to index
      scf.for %arg4 = %91 to %93 step %95 {
        %127 = builtin.unrealized_conversion_cast %arg4 : index to i64
        %128 = llvm.extractvalue %38[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %129 = llvm.extractvalue %38[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %130 = llvm.getelementptr %128[%129] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %131 = llvm.extractvalue %38[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %132 = llvm.mul %89, %131 overflow<nsw, nuw> : i64
        %133 = llvm.extractvalue %38[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %134 = llvm.mul %127, %133 overflow<nsw, nuw> : i64
        %135 = llvm.add %132, %134 overflow<nsw, nuw> : i64
        %136 = llvm.getelementptr inbounds|nuw %130[%135] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %137 = llvm.load %136 : !llvm.ptr -> f32
        %138 = llvm.extractvalue %36[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %139 = llvm.extractvalue %36[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %140 = llvm.getelementptr %138[%139] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %141 = llvm.extractvalue %36[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %142 = llvm.mul %127, %141 overflow<nsw, nuw> : i64
        %143 = llvm.extractvalue %36[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %144 = llvm.mul %81, %143 overflow<nsw, nuw> : i64
        %145 = llvm.add %142, %144 overflow<nsw, nuw> : i64
        %146 = llvm.getelementptr inbounds|nuw %140[%145] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %147 = llvm.load %146 : !llvm.ptr -> f32
        %148 = llvm.mlir.constant(0 : index) : i64
        %149 = llvm.mlir.constant(0 : index) : i64
        %150 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %151 = llvm.add %148, %149 overflow<nsw, nuw> : i64
        %152 = llvm.getelementptr inbounds|nuw %150[%151] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %153 = llvm.load %152 : !llvm.ptr -> f32
        %154 = llvm.fmul %137, %147 : f32
        %155 = llvm.fadd %153, %154 : f32
        %156 = llvm.mlir.constant(0 : index) : i64
        %157 = llvm.mlir.constant(0 : index) : i64
        %158 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %159 = llvm.add %156, %157 overflow<nsw, nuw> : i64
        %160 = llvm.getelementptr inbounds|nuw %158[%159] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        llvm.store %155, %160 : f32, !llvm.ptr
      }
      %96 = llvm.extractvalue %34[1] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %97 = llvm.extractvalue %34[2] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %98 = llvm.getelementptr %96[%97] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %99 = llvm.extractvalue %34[4, 0] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %100 = llvm.mul %81, %99 overflow<nsw, nuw> : i64
      %101 = llvm.getelementptr inbounds|nuw %98[%100] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %102 = llvm.load %101 : !llvm.ptr -> f32
      %103 = llvm.mlir.constant(0 : index) : i64
      %104 = llvm.mlir.constant(0 : index) : i64
      %105 = llvm.extractvalue %31[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %106 = llvm.add %103, %104 overflow<nsw, nuw> : i64
      %107 = llvm.getelementptr inbounds|nuw %105[%106] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %102, %107 : f32, !llvm.ptr
      %108 = llvm.mlir.constant(0 : index) : i64
      %109 = llvm.mlir.constant(0 : index) : i64
      %110 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %111 = llvm.add %108, %109 overflow<nsw, nuw> : i64
      %112 = llvm.getelementptr inbounds|nuw %110[%111] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %113 = llvm.load %112 : !llvm.ptr -> f32
      %114 = llvm.mlir.constant(0 : index) : i64
      %115 = llvm.mlir.constant(0 : index) : i64
      %116 = llvm.extractvalue %31[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %117 = llvm.add %114, %115 overflow<nsw, nuw> : i64
      %118 = llvm.getelementptr inbounds|nuw %116[%117] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %119 = llvm.load %118 : !llvm.ptr -> f32
      %120 = llvm.fadd %113, %119 : f32
      %121 = llvm.intr.maximum(%120, %32) : (f32, f32) -> f32
      %122 = llvm.extractvalue %64[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %123 = llvm.mlir.constant(53 : index) : i64
      %124 = llvm.mul %89, %123 overflow<nsw, nuw> : i64
      %125 = llvm.add %124, %81 overflow<nsw, nuw> : i64
      %126 = llvm.getelementptr inbounds|nuw %122[%125] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %121, %126 : f32, !llvm.ptr
    }
    %75 = bufferization.to_tensor %65 : memref<17x53xf32> to tensor<17x53xf32>
    return %75 : tensor<17x53xf32>
  }
  func.func @linear_with_sigmoid(%arg0: tensor<32x128xf32>, %arg1: tensor<128x64xf32>, %arg2: tensor<64xf32>) -> tensor<32x64xf32> {
    %0 = llvm.mlir.constant(1 : index) : i64
    %1 = llvm.mlir.constant(1 : index) : i64
    %2 = llvm.mlir.constant(1 : index) : i64
    %3 = llvm.mlir.zero : !llvm.ptr
    %4 = llvm.getelementptr %3[%0] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %5 = llvm.ptrtoint %4 : !llvm.ptr to i64
    %6 = llvm.call @malloc(%5) : (i64) -> !llvm.ptr
    %7 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %8 = llvm.insertvalue %6, %7[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %9 = llvm.insertvalue %6, %8[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %10 = llvm.mlir.constant(0 : index) : i64
    %11 = llvm.insertvalue %10, %9[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %12 = llvm.insertvalue %0, %11[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %13 = llvm.insertvalue %1, %12[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %14 = llvm.insertvalue %1, %13[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %15 = llvm.insertvalue %2, %14[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %16 = llvm.mlir.constant(1 : index) : i64
    %17 = llvm.mlir.constant(1 : index) : i64
    %18 = llvm.mlir.constant(1 : index) : i64
    %19 = llvm.mlir.zero : !llvm.ptr
    %20 = llvm.getelementptr %19[%16] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %21 = llvm.ptrtoint %20 : !llvm.ptr to i64
    %22 = llvm.call @malloc(%21) : (i64) -> !llvm.ptr
    %23 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %24 = llvm.insertvalue %22, %23[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %25 = llvm.insertvalue %22, %24[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %26 = llvm.mlir.constant(0 : index) : i64
    %27 = llvm.insertvalue %26, %25[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %28 = llvm.insertvalue %16, %27[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %29 = llvm.insertvalue %17, %28[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %30 = llvm.insertvalue %17, %29[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %31 = llvm.insertvalue %18, %30[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %32 = llvm.mlir.constant(1.000000e+00 : f32) : f32
    %33 = bufferization.to_buffer %arg2 : tensor<64xf32> to memref<64xf32, strided<[?], offset: ?>>
    %34 = builtin.unrealized_conversion_cast %33 : memref<64xf32, strided<[?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)>
    %35 = bufferization.to_buffer %arg1 : tensor<128x64xf32> to memref<128x64xf32, strided<[?, ?], offset: ?>>
    %36 = builtin.unrealized_conversion_cast %35 : memref<128x64xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %37 = bufferization.to_buffer %arg0 : tensor<32x128xf32> to memref<32x128xf32, strided<[?, ?], offset: ?>>
    %38 = builtin.unrealized_conversion_cast %37 : memref<32x128xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %39 = llvm.mlir.constant(32 : index) : i64
    %40 = llvm.mlir.constant(64 : index) : i64
    %41 = llvm.mlir.constant(1 : index) : i64
    %42 = llvm.mlir.constant(2048 : index) : i64
    %43 = llvm.mlir.zero : !llvm.ptr
    %44 = llvm.getelementptr %43[%42] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %45 = llvm.ptrtoint %44 : !llvm.ptr to i64
    %46 = llvm.mlir.constant(64 : index) : i64
    %47 = llvm.add %45, %46 : i64
    %48 = llvm.call @malloc(%47) : (i64) -> !llvm.ptr
    %49 = llvm.ptrtoint %48 : !llvm.ptr to i64
    %50 = llvm.mlir.constant(1 : index) : i64
    %51 = llvm.sub %46, %50 : i64
    %52 = llvm.add %49, %51 : i64
    %53 = llvm.urem %52, %46 : i64
    %54 = llvm.sub %52, %53 : i64
    %55 = llvm.inttoptr %54 : i64 to !llvm.ptr
    %56 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %57 = llvm.insertvalue %48, %56[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %58 = llvm.insertvalue %55, %57[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %59 = llvm.mlir.constant(0 : index) : i64
    %60 = llvm.insertvalue %59, %58[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %61 = llvm.insertvalue %39, %60[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %62 = llvm.insertvalue %40, %61[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %63 = llvm.insertvalue %40, %62[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %64 = llvm.insertvalue %41, %63[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %65 = builtin.unrealized_conversion_cast %64 : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> to memref<32x64xf32>
    %66 = llvm.mlir.constant(32 : index) : i64
    %67 = llvm.mlir.constant(64 : index) : i64
    %68 = llvm.mlir.constant(2048 : index) : i64
    %69 = llvm.mlir.constant(0 : index) : i64
    %70 = builtin.unrealized_conversion_cast %69 : i64 to index
    %71 = llvm.mlir.constant(2048 : index) : i64
    %72 = builtin.unrealized_conversion_cast %71 : i64 to index
    %73 = llvm.mlir.constant(1 : index) : i64
    %74 = builtin.unrealized_conversion_cast %73 : i64 to index
    scf.for %arg3 = %70 to %72 step %74 {
      %76 = builtin.unrealized_conversion_cast %arg3 : index to i64
      %77 = llvm.srem %76, %67 : i64
      %78 = llvm.mlir.constant(0 : index) : i64
      %79 = llvm.icmp "slt" %77, %78 : i64
      %80 = llvm.add %77, %67 : i64
      %81 = llvm.select %79, %80, %77 : i1, i64
      %82 = llvm.mlir.constant(0 : index) : i64
      %83 = llvm.mlir.constant(-1 : index) : i64
      %84 = llvm.icmp "slt" %76, %82 : i64
      %85 = llvm.sub %83, %76 : i64
      %86 = llvm.select %84, %85, %76 : i1, i64
      %87 = llvm.sdiv %86, %67 : i64
      %88 = llvm.sub %83, %87 : i64
      %89 = llvm.select %84, %88, %87 : i1, i64
      %90 = llvm.mlir.constant(0 : index) : i64
      %91 = builtin.unrealized_conversion_cast %90 : i64 to index
      %92 = llvm.mlir.constant(128 : index) : i64
      %93 = builtin.unrealized_conversion_cast %92 : i64 to index
      %94 = llvm.mlir.constant(1 : index) : i64
      %95 = builtin.unrealized_conversion_cast %94 : i64 to index
      scf.for %arg4 = %91 to %93 step %95 {
        %130 = builtin.unrealized_conversion_cast %arg4 : index to i64
        %131 = llvm.extractvalue %38[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %132 = llvm.extractvalue %38[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %133 = llvm.getelementptr %131[%132] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %134 = llvm.extractvalue %38[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %135 = llvm.mul %89, %134 overflow<nsw, nuw> : i64
        %136 = llvm.extractvalue %38[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %137 = llvm.mul %130, %136 overflow<nsw, nuw> : i64
        %138 = llvm.add %135, %137 overflow<nsw, nuw> : i64
        %139 = llvm.getelementptr inbounds|nuw %133[%138] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %140 = llvm.load %139 : !llvm.ptr -> f32
        %141 = llvm.extractvalue %36[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %142 = llvm.extractvalue %36[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %143 = llvm.getelementptr %141[%142] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %144 = llvm.extractvalue %36[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %145 = llvm.mul %130, %144 overflow<nsw, nuw> : i64
        %146 = llvm.extractvalue %36[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %147 = llvm.mul %81, %146 overflow<nsw, nuw> : i64
        %148 = llvm.add %145, %147 overflow<nsw, nuw> : i64
        %149 = llvm.getelementptr inbounds|nuw %143[%148] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %150 = llvm.load %149 : !llvm.ptr -> f32
        %151 = llvm.mlir.constant(0 : index) : i64
        %152 = llvm.mlir.constant(0 : index) : i64
        %153 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %154 = llvm.add %151, %152 overflow<nsw, nuw> : i64
        %155 = llvm.getelementptr inbounds|nuw %153[%154] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %156 = llvm.load %155 : !llvm.ptr -> f32
        %157 = llvm.fmul %140, %150 : f32
        %158 = llvm.fadd %156, %157 : f32
        %159 = llvm.mlir.constant(0 : index) : i64
        %160 = llvm.mlir.constant(0 : index) : i64
        %161 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %162 = llvm.add %159, %160 overflow<nsw, nuw> : i64
        %163 = llvm.getelementptr inbounds|nuw %161[%162] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        llvm.store %158, %163 : f32, !llvm.ptr
      }
      %96 = llvm.extractvalue %34[1] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %97 = llvm.extractvalue %34[2] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %98 = llvm.getelementptr %96[%97] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %99 = llvm.extractvalue %34[4, 0] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %100 = llvm.mul %81, %99 overflow<nsw, nuw> : i64
      %101 = llvm.getelementptr inbounds|nuw %98[%100] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %102 = llvm.load %101 : !llvm.ptr -> f32
      %103 = llvm.mlir.constant(0 : index) : i64
      %104 = llvm.mlir.constant(0 : index) : i64
      %105 = llvm.extractvalue %31[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %106 = llvm.add %103, %104 overflow<nsw, nuw> : i64
      %107 = llvm.getelementptr inbounds|nuw %105[%106] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %102, %107 : f32, !llvm.ptr
      %108 = llvm.mlir.constant(0 : index) : i64
      %109 = llvm.mlir.constant(0 : index) : i64
      %110 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %111 = llvm.add %108, %109 overflow<nsw, nuw> : i64
      %112 = llvm.getelementptr inbounds|nuw %110[%111] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %113 = llvm.load %112 : !llvm.ptr -> f32
      %114 = llvm.mlir.constant(0 : index) : i64
      %115 = llvm.mlir.constant(0 : index) : i64
      %116 = llvm.extractvalue %31[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %117 = llvm.add %114, %115 overflow<nsw, nuw> : i64
      %118 = llvm.getelementptr inbounds|nuw %116[%117] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %119 = llvm.load %118 : !llvm.ptr -> f32
      %120 = llvm.fadd %113, %119 : f32
      %121 = llvm.fneg %120 : f32
      %122 = math.exp %121 : f32
      %123 = llvm.fadd %122, %32 : f32
      %124 = llvm.fdiv %32, %123 : f32
      %125 = llvm.extractvalue %64[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %126 = llvm.mlir.constant(64 : index) : i64
      %127 = llvm.mul %89, %126 overflow<nsw, nuw> : i64
      %128 = llvm.add %127, %81 overflow<nsw, nuw> : i64
      %129 = llvm.getelementptr inbounds|nuw %125[%128] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %124, %129 : f32, !llvm.ptr
    }
    %75 = bufferization.to_tensor %65 : memref<32x64xf32> to tensor<32x64xf32>
    return %75 : tensor<32x64xf32>
  }
  func.func @linear_with_gelu(%arg0: tensor<32x128xf32>, %arg1: tensor<128x64xf32>, %arg2: tensor<64xf32>) -> tensor<32x64xf32> {
    %0 = llvm.mlir.constant(1 : index) : i64
    %1 = llvm.mlir.constant(1 : index) : i64
    %2 = llvm.mlir.constant(1 : index) : i64
    %3 = llvm.mlir.zero : !llvm.ptr
    %4 = llvm.getelementptr %3[%0] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %5 = llvm.ptrtoint %4 : !llvm.ptr to i64
    %6 = llvm.call @malloc(%5) : (i64) -> !llvm.ptr
    %7 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %8 = llvm.insertvalue %6, %7[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %9 = llvm.insertvalue %6, %8[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %10 = llvm.mlir.constant(0 : index) : i64
    %11 = llvm.insertvalue %10, %9[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %12 = llvm.insertvalue %0, %11[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %13 = llvm.insertvalue %1, %12[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %14 = llvm.insertvalue %1, %13[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %15 = llvm.insertvalue %2, %14[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %16 = llvm.mlir.constant(1 : index) : i64
    %17 = llvm.mlir.constant(1 : index) : i64
    %18 = llvm.mlir.constant(1 : index) : i64
    %19 = llvm.mlir.zero : !llvm.ptr
    %20 = llvm.getelementptr %19[%16] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %21 = llvm.ptrtoint %20 : !llvm.ptr to i64
    %22 = llvm.call @malloc(%21) : (i64) -> !llvm.ptr
    %23 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %24 = llvm.insertvalue %22, %23[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %25 = llvm.insertvalue %22, %24[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %26 = llvm.mlir.constant(0 : index) : i64
    %27 = llvm.insertvalue %26, %25[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %28 = llvm.insertvalue %16, %27[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %29 = llvm.insertvalue %17, %28[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %30 = llvm.insertvalue %17, %29[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %31 = llvm.insertvalue %18, %30[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %32 = llvm.mlir.constant(5.000000e-01 : f32) : f32
    %33 = llvm.mlir.constant(1.000000e+00 : f32) : f32
    %34 = llvm.mlir.constant(1.41421354 : f32) : f32
    %35 = bufferization.to_buffer %arg2 : tensor<64xf32> to memref<64xf32, strided<[?], offset: ?>>
    %36 = builtin.unrealized_conversion_cast %35 : memref<64xf32, strided<[?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)>
    %37 = bufferization.to_buffer %arg1 : tensor<128x64xf32> to memref<128x64xf32, strided<[?, ?], offset: ?>>
    %38 = builtin.unrealized_conversion_cast %37 : memref<128x64xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %39 = bufferization.to_buffer %arg0 : tensor<32x128xf32> to memref<32x128xf32, strided<[?, ?], offset: ?>>
    %40 = builtin.unrealized_conversion_cast %39 : memref<32x128xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %41 = llvm.mlir.constant(32 : index) : i64
    %42 = llvm.mlir.constant(64 : index) : i64
    %43 = llvm.mlir.constant(1 : index) : i64
    %44 = llvm.mlir.constant(2048 : index) : i64
    %45 = llvm.mlir.zero : !llvm.ptr
    %46 = llvm.getelementptr %45[%44] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %47 = llvm.ptrtoint %46 : !llvm.ptr to i64
    %48 = llvm.mlir.constant(64 : index) : i64
    %49 = llvm.add %47, %48 : i64
    %50 = llvm.call @malloc(%49) : (i64) -> !llvm.ptr
    %51 = llvm.ptrtoint %50 : !llvm.ptr to i64
    %52 = llvm.mlir.constant(1 : index) : i64
    %53 = llvm.sub %48, %52 : i64
    %54 = llvm.add %51, %53 : i64
    %55 = llvm.urem %54, %48 : i64
    %56 = llvm.sub %54, %55 : i64
    %57 = llvm.inttoptr %56 : i64 to !llvm.ptr
    %58 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %59 = llvm.insertvalue %50, %58[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %60 = llvm.insertvalue %57, %59[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %61 = llvm.mlir.constant(0 : index) : i64
    %62 = llvm.insertvalue %61, %60[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %63 = llvm.insertvalue %41, %62[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %64 = llvm.insertvalue %42, %63[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %65 = llvm.insertvalue %42, %64[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %66 = llvm.insertvalue %43, %65[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %67 = builtin.unrealized_conversion_cast %66 : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> to memref<32x64xf32>
    %68 = llvm.mlir.constant(32 : index) : i64
    %69 = llvm.mlir.constant(64 : index) : i64
    %70 = llvm.mlir.constant(2048 : index) : i64
    %71 = llvm.mlir.constant(0 : index) : i64
    %72 = builtin.unrealized_conversion_cast %71 : i64 to index
    %73 = llvm.mlir.constant(2048 : index) : i64
    %74 = builtin.unrealized_conversion_cast %73 : i64 to index
    %75 = llvm.mlir.constant(1 : index) : i64
    %76 = builtin.unrealized_conversion_cast %75 : i64 to index
    scf.for %arg3 = %72 to %74 step %76 {
      %78 = builtin.unrealized_conversion_cast %arg3 : index to i64
      %79 = llvm.srem %78, %69 : i64
      %80 = llvm.mlir.constant(0 : index) : i64
      %81 = llvm.icmp "slt" %79, %80 : i64
      %82 = llvm.add %79, %69 : i64
      %83 = llvm.select %81, %82, %79 : i1, i64
      %84 = llvm.mlir.constant(0 : index) : i64
      %85 = llvm.mlir.constant(-1 : index) : i64
      %86 = llvm.icmp "slt" %78, %84 : i64
      %87 = llvm.sub %85, %78 : i64
      %88 = llvm.select %86, %87, %78 : i1, i64
      %89 = llvm.sdiv %88, %69 : i64
      %90 = llvm.sub %85, %89 : i64
      %91 = llvm.select %86, %90, %89 : i1, i64
      %92 = llvm.mlir.constant(0 : index) : i64
      %93 = builtin.unrealized_conversion_cast %92 : i64 to index
      %94 = llvm.mlir.constant(128 : index) : i64
      %95 = builtin.unrealized_conversion_cast %94 : i64 to index
      %96 = llvm.mlir.constant(1 : index) : i64
      %97 = builtin.unrealized_conversion_cast %96 : i64 to index
      scf.for %arg4 = %93 to %95 step %97 {
        %133 = builtin.unrealized_conversion_cast %arg4 : index to i64
        %134 = llvm.extractvalue %40[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %135 = llvm.extractvalue %40[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %136 = llvm.getelementptr %134[%135] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %137 = llvm.extractvalue %40[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %138 = llvm.mul %91, %137 overflow<nsw, nuw> : i64
        %139 = llvm.extractvalue %40[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %140 = llvm.mul %133, %139 overflow<nsw, nuw> : i64
        %141 = llvm.add %138, %140 overflow<nsw, nuw> : i64
        %142 = llvm.getelementptr inbounds|nuw %136[%141] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %143 = llvm.load %142 : !llvm.ptr -> f32
        %144 = llvm.extractvalue %38[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %145 = llvm.extractvalue %38[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %146 = llvm.getelementptr %144[%145] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %147 = llvm.extractvalue %38[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %148 = llvm.mul %133, %147 overflow<nsw, nuw> : i64
        %149 = llvm.extractvalue %38[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %150 = llvm.mul %83, %149 overflow<nsw, nuw> : i64
        %151 = llvm.add %148, %150 overflow<nsw, nuw> : i64
        %152 = llvm.getelementptr inbounds|nuw %146[%151] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %153 = llvm.load %152 : !llvm.ptr -> f32
        %154 = llvm.mlir.constant(0 : index) : i64
        %155 = llvm.mlir.constant(0 : index) : i64
        %156 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %157 = llvm.add %154, %155 overflow<nsw, nuw> : i64
        %158 = llvm.getelementptr inbounds|nuw %156[%157] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %159 = llvm.load %158 : !llvm.ptr -> f32
        %160 = llvm.fmul %143, %153 : f32
        %161 = llvm.fadd %159, %160 : f32
        %162 = llvm.mlir.constant(0 : index) : i64
        %163 = llvm.mlir.constant(0 : index) : i64
        %164 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %165 = llvm.add %162, %163 overflow<nsw, nuw> : i64
        %166 = llvm.getelementptr inbounds|nuw %164[%165] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        llvm.store %161, %166 : f32, !llvm.ptr
      }
      %98 = llvm.extractvalue %36[1] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %99 = llvm.extractvalue %36[2] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %100 = llvm.getelementptr %98[%99] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %101 = llvm.extractvalue %36[4, 0] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %102 = llvm.mul %83, %101 overflow<nsw, nuw> : i64
      %103 = llvm.getelementptr inbounds|nuw %100[%102] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %104 = llvm.load %103 : !llvm.ptr -> f32
      %105 = llvm.mlir.constant(0 : index) : i64
      %106 = llvm.mlir.constant(0 : index) : i64
      %107 = llvm.extractvalue %31[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %108 = llvm.add %105, %106 overflow<nsw, nuw> : i64
      %109 = llvm.getelementptr inbounds|nuw %107[%108] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %104, %109 : f32, !llvm.ptr
      %110 = llvm.mlir.constant(0 : index) : i64
      %111 = llvm.mlir.constant(0 : index) : i64
      %112 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %113 = llvm.add %110, %111 overflow<nsw, nuw> : i64
      %114 = llvm.getelementptr inbounds|nuw %112[%113] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %115 = llvm.load %114 : !llvm.ptr -> f32
      %116 = llvm.mlir.constant(0 : index) : i64
      %117 = llvm.mlir.constant(0 : index) : i64
      %118 = llvm.extractvalue %31[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %119 = llvm.add %116, %117 overflow<nsw, nuw> : i64
      %120 = llvm.getelementptr inbounds|nuw %118[%119] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %121 = llvm.load %120 : !llvm.ptr -> f32
      %122 = llvm.fadd %115, %121 : f32
      %123 = llvm.fdiv %122, %34 : f32
      %124 = math.erf %123 : f32
      %125 = llvm.fadd %124, %33 : f32
      %126 = llvm.fmul %125, %32 : f32
      %127 = llvm.fmul %122, %126 : f32
      %128 = llvm.extractvalue %66[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %129 = llvm.mlir.constant(64 : index) : i64
      %130 = llvm.mul %91, %129 overflow<nsw, nuw> : i64
      %131 = llvm.add %130, %83 overflow<nsw, nuw> : i64
      %132 = llvm.getelementptr inbounds|nuw %128[%131] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %127, %132 : f32, !llvm.ptr
    }
    %77 = bufferization.to_tensor %67 : memref<32x64xf32> to tensor<32x64xf32>
    return %77 : tensor<32x64xf32>
  }
  func.func @linear_with_tanh(%arg0: tensor<32x128xf32>, %arg1: tensor<128x64xf32>, %arg2: tensor<64xf32>) -> tensor<32x64xf32> {
    %0 = llvm.mlir.constant(1 : index) : i64
    %1 = llvm.mlir.constant(1 : index) : i64
    %2 = llvm.mlir.constant(1 : index) : i64
    %3 = llvm.mlir.zero : !llvm.ptr
    %4 = llvm.getelementptr %3[%0] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %5 = llvm.ptrtoint %4 : !llvm.ptr to i64
    %6 = llvm.call @malloc(%5) : (i64) -> !llvm.ptr
    %7 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %8 = llvm.insertvalue %6, %7[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %9 = llvm.insertvalue %6, %8[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %10 = llvm.mlir.constant(0 : index) : i64
    %11 = llvm.insertvalue %10, %9[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %12 = llvm.insertvalue %0, %11[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %13 = llvm.insertvalue %1, %12[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %14 = llvm.insertvalue %1, %13[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %15 = llvm.insertvalue %2, %14[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %16 = llvm.mlir.constant(1 : index) : i64
    %17 = llvm.mlir.constant(1 : index) : i64
    %18 = llvm.mlir.constant(1 : index) : i64
    %19 = llvm.mlir.zero : !llvm.ptr
    %20 = llvm.getelementptr %19[%16] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %21 = llvm.ptrtoint %20 : !llvm.ptr to i64
    %22 = llvm.call @malloc(%21) : (i64) -> !llvm.ptr
    %23 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %24 = llvm.insertvalue %22, %23[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %25 = llvm.insertvalue %22, %24[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %26 = llvm.mlir.constant(0 : index) : i64
    %27 = llvm.insertvalue %26, %25[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %28 = llvm.insertvalue %16, %27[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %29 = llvm.insertvalue %17, %28[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %30 = llvm.insertvalue %17, %29[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %31 = llvm.insertvalue %18, %30[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %32 = bufferization.to_buffer %arg2 : tensor<64xf32> to memref<64xf32, strided<[?], offset: ?>>
    %33 = builtin.unrealized_conversion_cast %32 : memref<64xf32, strided<[?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)>
    %34 = bufferization.to_buffer %arg1 : tensor<128x64xf32> to memref<128x64xf32, strided<[?, ?], offset: ?>>
    %35 = builtin.unrealized_conversion_cast %34 : memref<128x64xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %36 = bufferization.to_buffer %arg0 : tensor<32x128xf32> to memref<32x128xf32, strided<[?, ?], offset: ?>>
    %37 = builtin.unrealized_conversion_cast %36 : memref<32x128xf32, strided<[?, ?], offset: ?>> to !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %38 = llvm.mlir.constant(32 : index) : i64
    %39 = llvm.mlir.constant(64 : index) : i64
    %40 = llvm.mlir.constant(1 : index) : i64
    %41 = llvm.mlir.constant(2048 : index) : i64
    %42 = llvm.mlir.zero : !llvm.ptr
    %43 = llvm.getelementptr %42[%41] : (!llvm.ptr, i64) -> !llvm.ptr, f32
    %44 = llvm.ptrtoint %43 : !llvm.ptr to i64
    %45 = llvm.mlir.constant(64 : index) : i64
    %46 = llvm.add %44, %45 : i64
    %47 = llvm.call @malloc(%46) : (i64) -> !llvm.ptr
    %48 = llvm.ptrtoint %47 : !llvm.ptr to i64
    %49 = llvm.mlir.constant(1 : index) : i64
    %50 = llvm.sub %45, %49 : i64
    %51 = llvm.add %48, %50 : i64
    %52 = llvm.urem %51, %45 : i64
    %53 = llvm.sub %51, %52 : i64
    %54 = llvm.inttoptr %53 : i64 to !llvm.ptr
    %55 = llvm.mlir.poison : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)>
    %56 = llvm.insertvalue %47, %55[0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %57 = llvm.insertvalue %54, %56[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %58 = llvm.mlir.constant(0 : index) : i64
    %59 = llvm.insertvalue %58, %57[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %60 = llvm.insertvalue %38, %59[3, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %61 = llvm.insertvalue %39, %60[3, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %62 = llvm.insertvalue %39, %61[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %63 = llvm.insertvalue %40, %62[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
    %64 = builtin.unrealized_conversion_cast %63 : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> to memref<32x64xf32>
    %65 = llvm.mlir.constant(32 : index) : i64
    %66 = llvm.mlir.constant(64 : index) : i64
    %67 = llvm.mlir.constant(2048 : index) : i64
    %68 = llvm.mlir.constant(0 : index) : i64
    %69 = builtin.unrealized_conversion_cast %68 : i64 to index
    %70 = llvm.mlir.constant(2048 : index) : i64
    %71 = builtin.unrealized_conversion_cast %70 : i64 to index
    %72 = llvm.mlir.constant(1 : index) : i64
    %73 = builtin.unrealized_conversion_cast %72 : i64 to index
    scf.for %arg3 = %69 to %71 step %73 {
      %75 = builtin.unrealized_conversion_cast %arg3 : index to i64
      %76 = llvm.srem %75, %66 : i64
      %77 = llvm.mlir.constant(0 : index) : i64
      %78 = llvm.icmp "slt" %76, %77 : i64
      %79 = llvm.add %76, %66 : i64
      %80 = llvm.select %78, %79, %76 : i1, i64
      %81 = llvm.mlir.constant(0 : index) : i64
      %82 = llvm.mlir.constant(-1 : index) : i64
      %83 = llvm.icmp "slt" %75, %81 : i64
      %84 = llvm.sub %82, %75 : i64
      %85 = llvm.select %83, %84, %75 : i1, i64
      %86 = llvm.sdiv %85, %66 : i64
      %87 = llvm.sub %82, %86 : i64
      %88 = llvm.select %83, %87, %86 : i1, i64
      %89 = llvm.mlir.constant(0 : index) : i64
      %90 = builtin.unrealized_conversion_cast %89 : i64 to index
      %91 = llvm.mlir.constant(128 : index) : i64
      %92 = builtin.unrealized_conversion_cast %91 : i64 to index
      %93 = llvm.mlir.constant(1 : index) : i64
      %94 = builtin.unrealized_conversion_cast %93 : i64 to index
      scf.for %arg4 = %90 to %92 step %94 {
        %126 = builtin.unrealized_conversion_cast %arg4 : index to i64
        %127 = llvm.extractvalue %37[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %128 = llvm.extractvalue %37[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %129 = llvm.getelementptr %127[%128] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %130 = llvm.extractvalue %37[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %131 = llvm.mul %88, %130 overflow<nsw, nuw> : i64
        %132 = llvm.extractvalue %37[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %133 = llvm.mul %126, %132 overflow<nsw, nuw> : i64
        %134 = llvm.add %131, %133 overflow<nsw, nuw> : i64
        %135 = llvm.getelementptr inbounds|nuw %129[%134] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %136 = llvm.load %135 : !llvm.ptr -> f32
        %137 = llvm.extractvalue %35[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %138 = llvm.extractvalue %35[2] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %139 = llvm.getelementptr %137[%138] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %140 = llvm.extractvalue %35[4, 0] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %141 = llvm.mul %126, %140 overflow<nsw, nuw> : i64
        %142 = llvm.extractvalue %35[4, 1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %143 = llvm.mul %80, %142 overflow<nsw, nuw> : i64
        %144 = llvm.add %141, %143 overflow<nsw, nuw> : i64
        %145 = llvm.getelementptr inbounds|nuw %139[%144] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %146 = llvm.load %145 : !llvm.ptr -> f32
        %147 = llvm.mlir.constant(0 : index) : i64
        %148 = llvm.mlir.constant(0 : index) : i64
        %149 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %150 = llvm.add %147, %148 overflow<nsw, nuw> : i64
        %151 = llvm.getelementptr inbounds|nuw %149[%150] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        %152 = llvm.load %151 : !llvm.ptr -> f32
        %153 = llvm.fmul %136, %146 : f32
        %154 = llvm.fadd %152, %153 : f32
        %155 = llvm.mlir.constant(0 : index) : i64
        %156 = llvm.mlir.constant(0 : index) : i64
        %157 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
        %158 = llvm.add %155, %156 overflow<nsw, nuw> : i64
        %159 = llvm.getelementptr inbounds|nuw %157[%158] : (!llvm.ptr, i64) -> !llvm.ptr, f32
        llvm.store %154, %159 : f32, !llvm.ptr
      }
      %95 = llvm.extractvalue %33[1] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %96 = llvm.extractvalue %33[2] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %97 = llvm.getelementptr %95[%96] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %98 = llvm.extractvalue %33[4, 0] : !llvm.struct<(ptr, ptr, i64, array<1 x i64>, array<1 x i64>)> 
      %99 = llvm.mul %80, %98 overflow<nsw, nuw> : i64
      %100 = llvm.getelementptr inbounds|nuw %97[%99] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %101 = llvm.load %100 : !llvm.ptr -> f32
      %102 = llvm.mlir.constant(0 : index) : i64
      %103 = llvm.mlir.constant(0 : index) : i64
      %104 = llvm.extractvalue %31[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %105 = llvm.add %102, %103 overflow<nsw, nuw> : i64
      %106 = llvm.getelementptr inbounds|nuw %104[%105] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %101, %106 : f32, !llvm.ptr
      %107 = llvm.mlir.constant(0 : index) : i64
      %108 = llvm.mlir.constant(0 : index) : i64
      %109 = llvm.extractvalue %15[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %110 = llvm.add %107, %108 overflow<nsw, nuw> : i64
      %111 = llvm.getelementptr inbounds|nuw %109[%110] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %112 = llvm.load %111 : !llvm.ptr -> f32
      %113 = llvm.mlir.constant(0 : index) : i64
      %114 = llvm.mlir.constant(0 : index) : i64
      %115 = llvm.extractvalue %31[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %116 = llvm.add %113, %114 overflow<nsw, nuw> : i64
      %117 = llvm.getelementptr inbounds|nuw %115[%116] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      %118 = llvm.load %117 : !llvm.ptr -> f32
      %119 = llvm.fadd %112, %118 : f32
      %120 = math.tanh %119 : f32
      %121 = llvm.extractvalue %63[1] : !llvm.struct<(ptr, ptr, i64, array<2 x i64>, array<2 x i64>)> 
      %122 = llvm.mlir.constant(64 : index) : i64
      %123 = llvm.mul %88, %122 overflow<nsw, nuw> : i64
      %124 = llvm.add %123, %80 overflow<nsw, nuw> : i64
      %125 = llvm.getelementptr inbounds|nuw %121[%124] : (!llvm.ptr, i64) -> !llvm.ptr, f32
      llvm.store %120, %125 : f32, !llvm.ptr
    }
    %74 = bufferization.to_tensor %64 : memref<32x64xf32> to tensor<32x64xf32>
    return %74 : tensor<32x64xf32>
  }
}

